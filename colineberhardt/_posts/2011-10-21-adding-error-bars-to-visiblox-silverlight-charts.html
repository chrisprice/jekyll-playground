---
author: Colin Eberhardt
tags: charts, databinding, visiblox
permalink: /blog/colin/2011/10/adding-error-bars-to-visiblox-silverlight-charts/index.html
layout: colineberhardt-blog
---
<div class="entry"><div class="topsy_widget_data topsy_theme_light-green" style="float: right; margin-left: 0.75em; background: url(data:,%7B%20%22url%22%3A%20%22http%253A%252F%252Fwww.scottlogic.co.uk%252Fblog%252Fcolin%252F2011%252F10%252Fadding-error-bars-to-visiblox-silverlight-charts%252F%22%2C%20%22style%22%3A%20%22big%22%2C%20%22title%22%3A%20%22Adding%20Error%20Bars%20to%20Visiblox%20Silverlight%20Charts%20%23%22%20%7D);"></div><p>Having spent a number of years studying Physics at university, I have had the importance of error bars well and truly drummed into me! Within physics, or any experimental science, there are always going to be errors in the measurements you make. The more repeat measurements you make, the more confident you can be in the mean value, however you cannot remove the errors altogether. Error bars provide a way to represent the spread of experimental observations graphically, without them, it is hard to have any confidence in the conclusions drawn from the observations!</p><p>In this blog post I will show how to implement a custom <a href="http://www.visiblox.com/">Visiblox</a> chart series to render error bars:</p><p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/10/VisibloxErrorBars.png" alt="" title="VisibloxErrorBars" width="499" height="240" class="aligncenter size-full wp-image-1767" /></p><p>(The data in the above chart is from a page which details how to calculate the <a href="http://www.ncsu.edu/labwrite/res/gt/gt-stat-home.html">standard error from experimental results</a>).</p><h2>Creating a Custom Series</h2><p>As described in my previous blog post on <a href="{{ site.url }}/blog/colin/2010/11/adding-a-smoothed-line-series-bezier-curve-to-a-visiblox-chart/" title="Adding a Smoothed Line Series (Bézier curve) to a Visiblox Chart">creating a spline series</a>, to create a new series type, you sub-class one of the Visiblox base-classes, in this case <code>MultiValueSeriesBase </code>is a suitable starting point:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> ErrorBarSeries <span style="color: #008000;">:</span> MultiValueSeriesBase
<span style="color: #008000;">{</span> 
  <span style="color: #0600FF; font-weight: bold;">protected</span> <span style="color: #0600FF; font-weight: bold;">override</span> FrameworkElement CreatePoint<span style="color: #008000;">(</span>IDataPoint dataPoint<span style="color: #008000;">)</span>
  <span style="color: #008000;">{</span>
    <span style="color: #0600FF; font-weight: bold;">throw</span> <span style="color: #008000;">new</span> NotImplementedException<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #008000;">}</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">protected</span> <span style="color: #0600FF; font-weight: bold;">override</span> <span style="color: #6666cc; font-weight: bold;">void</span> RenderDataLabels<span style="color: #008000;">(</span><span style="color: #008000;">)</span>
  <span style="color: #008000;">{</span>
    <span style="color: #0600FF; font-weight: bold;">throw</span> <span style="color: #008000;">new</span> NotImplementedException<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #008000;">}</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>I don’t want data labels, so the only method I need to implement is <code>CreatePoint</code>, which takes the (multi-valued) point to be rendered as its only argument. The lifecycle of point creating and destruction is taken care of by the base-class.</p><p>The <code>IDataPoint </code>has a string indexer which is used to retrieve multiple Y values for multi-valued series. It is a good idea to define these in a single place, here we define the three y-values required for an error-bar series:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #0600FF; font-weight: bold;">readonly</span> <span style="color: #6666cc; font-weight: bold;">string</span> ErrorUp <span style="color: #008000;">=</span> <span style="color: #666666;">"ErrorUp"</span><span style="color: #008000;">;</span>
&nbsp;
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #0600FF; font-weight: bold;">readonly</span> <span style="color: #6666cc; font-weight: bold;">string</span> ErrorDown <span style="color: #008000;">=</span> <span style="color: #666666;">"ErrorDown"</span><span style="color: #008000;">;</span>
&nbsp;
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #0600FF; font-weight: bold;">readonly</span> <span style="color: #6666cc; font-weight: bold;">string</span> <span style="color: #0600FF; font-weight: bold;">Value</span> <span style="color: #008000;">=</span> <span style="color: #666666;">"Value"</span><span style="color: #008000;">;</span></pre></td></tr></table></div><p>The <code>CreatePoint</code> implementation for this series creates a Path as follows:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">protected</span> <span style="color: #0600FF; font-weight: bold;">override</span> FrameworkElement CreatePoint<span style="color: #008000;">(</span>IDataPoint dataPoint<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> lineGeometry <span style="color: #008000;">=</span> BuildGeometry<span style="color: #008000;">(</span>dataPoint<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  Path line <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> Path<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  line<span style="color: #008000;">.</span><span style="color: #0000FF;">Stroke</span> <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> SolidColorBrush<span style="color: #008000;">(</span>Colors<span style="color: #008000;">.</span><span style="color: #0000FF;">Black</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  line<span style="color: #008000;">.</span><span style="color: #0000FF;">Fill</span> <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> SolidColorBrush<span style="color: #008000;">(</span>Colors<span style="color: #008000;">.</span><span style="color: #0000FF;">Gray</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  line<span style="color: #008000;">.</span><span style="color: #0000FF;">StrokeThickness</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">1.0</span><span style="color: #008000;">;</span>
  line<span style="color: #008000;">.</span><span style="color: #0000FF;">StrokeLineJoin</span> <span style="color: #008000;">=</span> PenLineJoin<span style="color: #008000;">.</span><span style="color: #0000FF;">Bevel</span><span style="color: #008000;">;</span>
  line<span style="color: #008000;">.</span><span style="color: #0000FF;">Data</span> <span style="color: #008000;">=</span> lineGeometry<span style="color: #008000;">;</span>
  line<span style="color: #008000;">.</span><span style="color: #0000FF;">SetValue</span><span style="color: #008000;">(</span>ZoomCanvas<span style="color: #008000;">.</span><span style="color: #0000FF;">IsScaledPathProperty</span>, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">return</span> line<span style="color: #008000;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>The <code>BuildGeometry</code> method does most of the work, extracting the values from the IDataPoint, transforming them (via the axis) to the required coordinate system, then creating a suitable geometry:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// Creates the geometry for the given datapoint</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #0600FF; font-weight: bold;">private</span> PathGeometry BuildGeometry<span style="color: #008000;">(</span>IDataPoint dataPoint<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> halfWidth <span style="color: #008000;">=</span> SuggestedPointWidth <span style="color: #008000;">*</span> WidthFactor<span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #008080; font-style: italic;">// obtain the data values</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> topDataValue <span style="color: #008000;">=</span> dataPoint<span style="color: #008000;">[</span>ErrorUp<span style="color: #008000;">]</span> <span style="color: #0600FF; font-weight: bold;">as</span> IComparable<span style="color: #008000;">;</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> middleDataValue <span style="color: #008000;">=</span> dataPoint<span style="color: #008000;">[</span><span style="color: #0600FF; font-weight: bold;">Value</span><span style="color: #008000;">]</span> <span style="color: #0600FF; font-weight: bold;">as</span> IComparable<span style="color: #008000;">;</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> bottomDataValue <span style="color: #008000;">=</span> dataPoint<span style="color: #008000;">[</span>ErrorDown<span style="color: #008000;">]</span> <span style="color: #0600FF; font-weight: bold;">as</span> IComparable<span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #008080; font-style: italic;">// convert to a the required render coordinates</span>
  <span style="color: #6666cc; font-weight: bold;">double</span> topRenderPos <span style="color: #008000;">=</span> YAxis<span style="color: #008000;">.</span><span style="color: #0000FF;">GetDataValueAsRenderPositionWithoutZoom</span><span style="color: #008000;">(</span>topDataValue<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #6666cc; font-weight: bold;">double</span> middleRenderPos <span style="color: #008000;">=</span> YAxis<span style="color: #008000;">.</span><span style="color: #0000FF;">GetDataValueAsRenderPositionWithoutZoom</span><span style="color: #008000;">(</span>middleDataValue<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #6666cc; font-weight: bold;">double</span> bottomRenderPos <span style="color: #008000;">=</span> YAxis<span style="color: #008000;">.</span><span style="color: #0000FF;">GetDataValueAsRenderPositionWithoutZoom</span><span style="color: #008000;">(</span>bottomDataValue<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #6666cc; font-weight: bold;">double</span> xMiddleRenderPos <span style="color: #008000;">=</span> XAxis<span style="color: #008000;">.</span><span style="color: #0000FF;">GetDataValueAsRenderPositionWithoutZoom</span><span style="color: #008000;">(</span>dataPoint<span style="color: #008000;">.</span><span style="color: #0000FF;">X</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #6666cc; font-weight: bold;">double</span> xRightRenderPos <span style="color: #008000;">=</span> xMiddleRenderPos <span style="color: #008000;">-</span> halfWidth<span style="color: #008000;">;</span>
  <span style="color: #6666cc; font-weight: bold;">double</span> xLeftRenderPos <span style="color: #008000;">=</span> xMiddleRenderPos <span style="color: #008000;">+</span> halfWidth<span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #008080; font-style: italic;">// build a suitable gemoetry</span>
  PathGeometry lineGeometry <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> PathGeometry<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  PathFigure upperVerticalLine <span style="color: #008000;">=</span> CreateLineFigure<span style="color: #008000;">(</span>
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xMiddleRenderPos, middleRenderPos <span style="color: #008000;">-</span> halfWidth<span style="color: #008000;">)</span>,
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xMiddleRenderPos, topRenderPos<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  lineGeometry<span style="color: #008000;">.</span><span style="color: #0000FF;">Figures</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>upperVerticalLine<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  PathFigure lowerVerticalLine <span style="color: #008000;">=</span> CreateLineFigure<span style="color: #008000;">(</span>
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xMiddleRenderPos, bottomRenderPos<span style="color: #008000;">)</span>,
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xMiddleRenderPos, middleRenderPos <span style="color: #008000;">+</span> halfWidth<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  lineGeometry<span style="color: #008000;">.</span><span style="color: #0000FF;">Figures</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>lowerVerticalLine<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  PathFigure upperBar <span style="color: #008000;">=</span> CreateLineFigure<span style="color: #008000;">(</span>
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xLeftRenderPos, topRenderPos<span style="color: #008000;">)</span>,
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xRightRenderPos, topRenderPos<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  lineGeometry<span style="color: #008000;">.</span><span style="color: #0000FF;">Figures</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>upperBar<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  PathFigure lowerBar <span style="color: #008000;">=</span> CreateLineFigure<span style="color: #008000;">(</span>
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xLeftRenderPos, bottomRenderPos<span style="color: #008000;">)</span>,
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xRightRenderPos, bottomRenderPos<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  lineGeometry<span style="color: #008000;">.</span><span style="color: #0000FF;">Figures</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>lowerBar<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  PathFigure center <span style="color: #008000;">=</span> CreateLineFigure<span style="color: #008000;">(</span>
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xMiddleRenderPos <span style="color: #008000;">-</span> halfWidth, middleRenderPos<span style="color: #008000;">)</span>,
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xMiddleRenderPos, middleRenderPos <span style="color: #008000;">+</span> halfWidth<span style="color: #008000;">)</span>,
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xMiddleRenderPos <span style="color: #008000;">+</span> halfWidth, middleRenderPos<span style="color: #008000;">)</span>,
    <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span>xMiddleRenderPos, middleRenderPos <span style="color: #008000;">-</span> halfWidth<span style="color: #008000;">)</span>
  <span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  lineGeometry<span style="color: #008000;">.</span><span style="color: #0000FF;">Figures</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>center<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">return</span> lineGeometry<span style="color: #008000;">;</span>
<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// Create a line figure that connects the given points</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #0600FF; font-weight: bold;">private</span> PathFigure CreateLineFigure<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">params</span> Point<span style="color: #008000;">[</span><span style="color: #008000;">]</span> points<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
  <span style="color: #008080; font-style: italic;">// add all the points (except the first)</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> pointCollection <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> PointCollection<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #0600FF; font-weight: bold;">foreach</span> <span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">var</span> point <span style="color: #0600FF; font-weight: bold;">in</span> points<span style="color: #008000;">.</span><span style="color: #0000FF;">Skip</span><span style="color: #008000;">(</span><span style="color: #FF0000;">1</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span>
  <span style="color: #008000;">{</span>
    pointCollection<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>point<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #008000;">}</span>
&nbsp;
  <span style="color: #008080; font-style: italic;">// create a figure, using the first point as the StartPoint.</span>
  <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">new</span> PathFigure<span style="color: #008000;">(</span><span style="color: #008000;">)</span>
  <span style="color: #008000;">{</span>
    IsClosed <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">true</span>,
    StartPoint <span style="color: #008000;">=</span> points<span style="color: #008000;">.</span><span style="color: #0000FF;">First</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span>,
    Segments <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> PathSegmentCollection<span style="color: #008000;">(</span><span style="color: #008000;">)</span>
    <span style="color: #008000;">{</span>
      <span style="color: #008000;">new</span> PolyLineSegment
      <span style="color: #008000;">{</span>
        Points <span style="color: #008000;">=</span> pointCollection
      <span style="color: #008000;">}</span>
    <span style="color: #008000;">}</span>
  <span style="color: #008000;">}</span><span style="color: #008000;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>We can now create an instance of this series in XAML:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;vis:Chart</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">"chart"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;vis:Chart.Series<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:ErrorBarSeries</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/vis:Chart.Series<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/vis:Chart<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div><p>Supplying data to the chart via <code>MultiValuedDataPoint</code> as follows:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> MainPage<span style="color: #008000;">(</span><span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
  InitializeComponent<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">var</span> data <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> DataSeries<span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">double</span>, <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&gt;</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  data<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreatePoint<span style="color: #008000;">(</span><span style="color: #008000;">-</span><span style="color: #FF0000;">195</span>, <span style="color: #FF0000;">1.4</span>, <span style="color: #FF0000;">0.2</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  data<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreatePoint<span style="color: #008000;">(</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">62.2</span>, <span style="color: #FF0000;">9.3</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  data<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreatePoint<span style="color: #008000;">(</span><span style="color: #FF0000;">20</span>, <span style="color: #FF0000;">70.4</span>, <span style="color: #FF0000;">6.5</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  data<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreatePoint<span style="color: #008000;">(</span><span style="color: #FF0000;">100</span>, <span style="color: #FF0000;">77.4</span>, <span style="color: #FF0000;">1.9</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  chart<span style="color: #008000;">.</span><span style="color: #0000FF;">Series</span><span style="color: #008000;">[</span><span style="color: #FF0000;">0</span><span style="color: #008000;">]</span><span style="color: #008000;">.</span><span style="color: #0000FF;">DataSeries</span> <span style="color: #008000;">=</span> data<span style="color: #008000;">;</span>
<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #0600FF; font-weight: bold;">private</span> MultiValuedDataPoint<span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">double</span>, <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&gt;</span> CreatePoint<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">double</span> x, <span style="color: #6666cc; font-weight: bold;">double</span> y, <span style="color: #6666cc; font-weight: bold;">double</span> error<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> point <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> MultiValuedDataPoint<span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">double</span>, <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&gt;</span><span style="color: #008000;">(</span>x,
    <span style="color: #008000;">new</span> Dictionary<span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">object</span>, <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&gt;</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span>
    <span style="color: #008000;">{</span>
      <span style="color: #008000;">{</span> ErrorBarSeries<span style="color: #008000;">.</span><span style="color: #0000FF;">ErrorUp</span>, y <span style="color: #008000;">+</span> error <span style="color: #008000;">}</span>,
      <span style="color: #008000;">{</span> ErrorBarSeries<span style="color: #008000;">.</span><span style="color: #0000FF;">ErrorDown</span>, y <span style="color: #008000;">-</span> error <span style="color: #008000;">}</span>,
      <span style="color: #008000;">{</span> ErrorBarSeries<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Value</span>, y <span style="color: #008000;">}</span>
    <span style="color: #008000;">}</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #0600FF; font-weight: bold;">return</span> point<span style="color: #008000;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>This results in the following chart:</p><p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/10/VisibloxErrorBars2.png" alt="" title="VisibloxErrorBars2" width="476" height="293" class="aligncenter size-full wp-image-1772" /></p><h2>Binding to a Multi-valued Series</h2><p>In the previous example we created instances of <code>MultiValuedDataPoint</code>, a Visiblox type for representing multi-valued points. As an alternative, we can create model objects to represent each point, rendering them in the chart via databinding.</p><p>We first modify the code to create a collection of <code>Measurement</code> instances (a simple model object that implements <code>INotifyPropertyChanged</code>):</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> MainPage<span style="color: #008000;">(</span><span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
  InitializeComponent<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">var</span> data <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> ObservableCollection<span style="color: #008000;">&lt;</span>Measurement<span style="color: #008000;">&gt;</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  data<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateMeasurement<span style="color: #008000;">(</span><span style="color: #008000;">-</span><span style="color: #FF0000;">195</span>, <span style="color: #FF0000;">1.4</span>, <span style="color: #FF0000;">0.2</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  data<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateMeasurement<span style="color: #008000;">(</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">62.2</span>, <span style="color: #FF0000;">9.3</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  data<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateMeasurement<span style="color: #008000;">(</span><span style="color: #FF0000;">20</span>, <span style="color: #FF0000;">70.4</span>, <span style="color: #FF0000;">6.5</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  data<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateMeasurement<span style="color: #008000;">(</span><span style="color: #FF0000;">100</span>, <span style="color: #FF0000;">77.4</span>, <span style="color: #FF0000;">1.9</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">DataContext</span> <span style="color: #008000;">=</span> data<span style="color: #008000;">;</span>    
<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #0600FF; font-weight: bold;">private</span> Measurement CreateMeasurement<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">double</span> x, <span style="color: #6666cc; font-weight: bold;">double</span> y, <span style="color: #6666cc; font-weight: bold;">double</span> error<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
  <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">new</span> Measurement<span style="color: #008000;">(</span><span style="color: #008000;">)</span>
    <span style="color: #008000;">{</span>
      XValue <span style="color: #008000;">=</span> x,
      YValue <span style="color: #008000;">=</span> y,
      YValueErrorUp <span style="color: #008000;">=</span> y <span style="color: #008000;">+</span> error,
      YValueErrorDown <span style="color: #008000;">=</span> y <span style="color: #008000;">-</span> error
    <span style="color: #008000;">}</span><span style="color: #008000;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>The markup for the chart is modified to use a <code>BindableDataSeries</code>, with bindings specified for the various component of the error bar series. Also, the <code>ItemsSource </code>of the <code>BindableDataSeries</code> is bound to the inherited <code>DataContext</code>:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #008000;">&lt;</span>local<span style="color: #008000;">:</span>ErrorBarSeries<span style="color: #008000;">&gt;</span>
  <span style="color: #008000;">&lt;</span>local<span style="color: #008000;">:</span>ErrorBarSeries<span style="color: #008000;">.</span><span style="color: #0000FF;">DataSeries</span><span style="color: #008000;">&gt;</span>
    <span style="color: #008000;">&lt;</span>vis<span style="color: #008000;">:</span>BindableDataSeries ItemsSource<span style="color: #008000;">=</span><span style="color: #666666;">"{Binding}"</span>
                            XValueBinding<span style="color: #008000;">=</span><span style="color: #666666;">"{Binding XValue}"</span><span style="color: #008000;">&gt;</span>
      <span style="color: #008000;">&lt;</span>vis<span style="color: #008000;">:</span>BindableDataSeries<span style="color: #008000;">.</span><span style="color: #0000FF;">YValueBindings</span><span style="color: #008000;">&gt;</span>
        <span style="color: #008000;">&lt;</span>vis<span style="color: #008000;">:</span>YValueBinding YValueKey<span style="color: #008000;">=</span><span style="color: #666666;">"Value"</span> Binding<span style="color: #008000;">=</span><span style="color: #666666;">"{Binding YValue}"</span><span style="color: #008000;">/&gt;</span>
        <span style="color: #008000;">&lt;</span>vis<span style="color: #008000;">:</span>YValueBinding YValueKey<span style="color: #008000;">=</span><span style="color: #666666;">"ErrorUp"</span> Binding<span style="color: #008000;">=</span><span style="color: #666666;">"{Binding YValueErrorUp}"</span><span style="color: #008000;">/&gt;</span>
        <span style="color: #008000;">&lt;</span>vis<span style="color: #008000;">:</span>YValueBinding YValueKey<span style="color: #008000;">=</span><span style="color: #666666;">"ErrorDown"</span>  Binding<span style="color: #008000;">=</span><span style="color: #666666;">"{Binding YValueErrorDown}"</span><span style="color: #008000;">/&gt;</span>
      <span style="color: #008000;">&lt;/</span>vis<span style="color: #008000;">:</span>BindableDataSeries<span style="color: #008000;">.</span><span style="color: #0000FF;">YValueBindings</span><span style="color: #008000;">&gt;</span>              
    <span style="color: #008000;">&lt;/</span>vis<span style="color: #008000;">:</span>BindableDataSeries<span style="color: #008000;">&gt;</span>
  <span style="color: #008000;">&lt;/</span>local<span style="color: #008000;">:</span>ErrorBarSeries<span style="color: #008000;">.</span><span style="color: #0000FF;">DataSeries</span><span style="color: #008000;">&gt;</span>
<span style="color: #008000;">&lt;/</span>local<span style="color: #008000;">:</span>ErrorBarSeries<span style="color: #008000;">&gt;</span></pre></td></tr></table></div><p>We can also display our data in a DataGrid, allowing us to manipulate the values (not that I condone manipulation of scientific data!), with the changes being reflected in the chart:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;sdk:DataGrid</span> <span style="color: #000066;">Grid.Row</span>=<span style="color: #ff0000;">"1"</span></span>
<span style="color: #009900;">              <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">"grid"</span></span>
<span style="color: #009900;">              <span style="color: #000066;">ItemsSource</span>=<span style="color: #ff0000;">"{Binding}"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span></pre></td></tr></table></div><p>This gives us the following application:</p><div style="text-align: center;"><object width="500" height="400" data="data:application/x-silverlight," type="application/x-silverlight-2"><param name="source" value="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/10/VisibloxErrorBarSeries.xap" /><a href="http://go.microsoft.com/fwlink/?LinkID=124807" style="text-decoration: none;"> <img src="http://go.microsoft.com/fwlink/?LinkId=108181" alt="Get Microsoft Silverlight" style="border-style: none;" /></a></object></div><p>You can edit the values, with the changes reflected immediately in the chart above.</p><p>You can download the sourcecode for the above example here:  <a href="{{ site.url }}/blog/colin/wp-content/uploads/2011/10/VisibloxErrorBarSeries.zip">VisibloxErrorBarSeries.zip</a></p><p>Regards, Colin E.</p></div>