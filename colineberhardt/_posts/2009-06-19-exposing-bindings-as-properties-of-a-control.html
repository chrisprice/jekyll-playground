---
author: Colin Eberhardt
tags: binding, silverlight, WPF
permalink: /blog/colin/2009/06/exposing-bindings-as-properties-of-a-control/index.html
layout: colineberhardt-blog
---
<div class="entry"><div class="topsy_widget_data topsy_theme_light-green" style="float: right; margin-left: 0.75em; background: url(data:,%7B%20%22url%22%3A%20%22http%253A%252F%252Fwww.scottlogic.co.uk%252Fblog%252Fcolin%252F2009%252F06%252Fexposing-bindings-as-properties-of-a-control%252F%22%2C%20%22style%22%3A%20%22big%22%2C%20%22title%22%3A%20%22Exposing%20Bindings%20as%20Properties%20of%20a%20Control%20%23%22%20%7D);"></div><p><a href="{{ site.url }}/blog/colin/wp-content/uploads/2009/06/card.png"><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2009/06/card.png" alt="card" title="card" width="228" height="128" class="aligncenter size-full wp-image-336" /></a></p><p>I must admit that the title of this post is not entirely clear, however I couldn’t find a way to sum up the content in one short sentence, so we’ll dive straight into an example. Let’s say for example you have developed a funky little business-card as illustrated above, using the simple XAML below:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Border</span> <span style="color: #000066;">BorderBrush</span>=<span style="color: #ff0000;">"LightGray"</span> <span style="color: #000066;">Background</span>=<span style="color: #ff0000;">"White"</span>  <span style="color: #000066;">BorderThickness</span>=<span style="color: #ff0000;">"1.5"</span> <span style="color: #000066;">CornerRadius</span>=<span style="color: #ff0000;">"20"</span></span>
<span style="color: #009900;">        <span style="color: #000066;">Width</span>=<span style="color: #ff0000;">"220"</span> <span style="color: #000066;">Height</span>=<span style="color: #ff0000;">"120"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Border</span> <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"5"</span> <span style="color: #000066;">BorderBrush</span>=<span style="color: #ff0000;">"LightGray"</span> <span style="color: #000066;">BorderThickness</span>=<span style="color: #ff0000;">"1.5"</span> <span style="color: #000066;">CornerRadius</span>=<span style="color: #ff0000;">"15"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Border.Background<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;ImageBrush<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;ImageBrush.ImageSource<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;BitmapImage</span> <span style="color: #000066;">UriSource</span>=<span style="color: #ff0000;">"back.jpg"</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/ImageBrush.ImageSource<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/ImageBrush<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Border.Background<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
&nbsp;
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;StackPanel</span> <span style="color: #000066;">Orientation</span>=<span style="color: #ff0000;">"Vertical"</span> <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"10"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"{Binding Name}"</span></span>
<span style="color: #009900;">                       <span style="color: #000066;">FontSize</span>=<span style="color: #ff0000;">"15"</span> <span style="color: #000066;">FontWeight</span>=<span style="color: #ff0000;">"Bold"</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Rectangle</span> <span style="color: #000066;">Stroke</span>=<span style="color: #ff0000;">"DarkGray"</span> <span style="color: #000066;">HorizontalAlignment</span>=<span style="color: #ff0000;">"Stretch"</span></span>
<span style="color: #009900;">                       <span style="color: #000066;">StrokeThickness</span>=<span style="color: #ff0000;">"0.5"</span> <span style="color: #000066;">Fill</span>=<span style="color: #ff0000;">"Black"</span> <span style="color: #000066;">Height</span>=<span style="color: #ff0000;">"1"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"0,10,0,0"</span>  <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"{Binding Company}"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;StackPanel</span> <span style="color: #000066;">Orientation</span>=<span style="color: #ff0000;">"Horizontal"</span> <span style="color: #000000; font-weight: bold;">&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"e: "</span> <span style="color: #000066;">FontSize</span>=<span style="color: #ff0000;">"10"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"{Binding Email}"</span> <span style="color: #000066;">FontSize</span>=<span style="color: #ff0000;">"10"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/StackPanel<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;StackPanel</span> <span style="color: #000066;">Orientation</span>=<span style="color: #ff0000;">"Horizontal"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"w: "</span> <span style="color: #000066;">FontSize</span>=<span style="color: #ff0000;">"10"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;HyperlinkButton</span> <span style="color: #000066;">Content</span>=<span style="color: #ff0000;">"{Binding Web}"</span> <span style="color: #000066;">FontSize</span>=<span style="color: #ff0000;">"10"</span></span>
<span style="color: #009900;">                             <span style="color: #000066;">NavigateUri</span>=<span style="color: #ff0000;">"{Binding Web}"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/StackPanel<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/StackPanel<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Border<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Border<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div><p>The above XAML creates a simple visual layout that binds to the Name, Email, Web and Company properties of the data object which is presented to the inherited DataContext. Nice and simple.</p><p>Now, let’s say you want to re-use this XAML markup in a number of places across your application. The obvious solution is to package it within a UserControl. However, elsewhere within the application contact details are stored in different types, with different properties, perhaps the property Web is used in some places, whereas the property URL is used elsewhere. If our UserControl simply contains the XAML markup given above, the binding paths are hard-coded and inflexible. So, how do we package the above markup for re-use whilst maintaining flexibility?</p><p>In UI frameworks which do not support databinding the obvious choice would be to define an interface IContactDetails, which defines a compile-time contract that clients of the control must implement on their business objects. This would allow us to enforce the presence of properties with specific names. However, with WPF / Silverlight the binding framework removes the need for controls to demand the presence of a certain interface and life is now much better as a result!</p><p>So … what we really want here is to allow the clients of our ContactDetails user control to provide bindings for the various framework elements within the user control itself. </p><p>Bindings can be constructed in code-behind by invoking the SetBinding method defined on DependencyObject as show in the example below:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #008080; font-style: italic;">// create a binding with a given source and property-path</span>
Binding binding <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> Binding<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
binding<span style="color: #008000;">.</span><span style="color: #0000FF;">Source</span> <span style="color: #008000;">=</span> myClass<span style="color: #008000;">;</span>
binding<span style="color: #008000;">.</span><span style="color: #0000FF;">Path</span> <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> PropertyPath<span style="color: #008000;">(</span><span style="color: #666666;">"WindowTitle"</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
<span style="color: #008080; font-style: italic;">// bind the button's Content property</span>
button<span style="color: #008000;">.</span><span style="color: #0000FF;">SetBinding</span><span style="color: #008000;">(</span>Button<span style="color: #008000;">.</span><span style="color: #0000FF;">ContentProperty</span>, binding<span style="color: #008000;">)</span><span style="color: #008000;">;</span></pre></td></tr></table></div><p>Therefore, if we were to expose the various Bindings as properties of the control (hence this blog post’s title), we could set the name, email, web elements binding accordingly using the Setbinding method.</p><p>The first time I tried this I added a NameBinding dependency property of type Binding to my UserControl, so that the client XAML looked as follows:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:ContactDetailsControl</span></span>
<span style="color: #009900;">    <span style="color: #000066;">NameBinding</span>=<span style="color: #ff0000;">"{Binding Name}"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span></pre></td></tr></table></div><p>However, this didn’t quite have the desired effect. When the XAML reader processes the above markup it creates the Binding object that we are after, however it does not set the NameBinding property value to this binding. Instead, it uses it to <em>bind</em> the NameBinding property. </p><p>The solution to the problem is to make NameBinding a standard CLR property. This time when the XAML reader encounters the above markup it once again creates the Binding object, but since NameBinding is not a dependency property it does not use it to bind the property, it simply sets the property value.</p><p>The code-behind of our ContactDetails user control looks like this:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">partial</span> <span style="color: #6666cc; font-weight: bold;">class</span> ContactDetailsControl <span style="color: #008000;">:</span> UserControl
<span style="color: #008000;">{</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> Binding NameBinding <span style="color: #008000;">{</span> <span style="color: #0600FF; font-weight: bold;">get</span><span style="color: #008000;">;</span> <span style="color: #0600FF; font-weight: bold;">set</span><span style="color: #008000;">;</span> <span style="color: #008000;">}</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> Binding CompanyBinding <span style="color: #008000;">{</span> <span style="color: #0600FF; font-weight: bold;">get</span><span style="color: #008000;">;</span> <span style="color: #0600FF; font-weight: bold;">set</span><span style="color: #008000;">;</span> <span style="color: #008000;">}</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> Binding WebBinding <span style="color: #008000;">{</span> <span style="color: #0600FF; font-weight: bold;">get</span><span style="color: #008000;">;</span> <span style="color: #0600FF; font-weight: bold;">set</span><span style="color: #008000;">;</span> <span style="color: #008000;">}</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> Binding EmailBinding <span style="color: #008000;">{</span> <span style="color: #0600FF; font-weight: bold;">get</span><span style="color: #008000;">;</span> <span style="color: #0600FF; font-weight: bold;">set</span><span style="color: #008000;">;</span> <span style="color: #008000;">}</span>
&nbsp;
    <span style="color: #0600FF; font-weight: bold;">public</span> ContactDetailsControl<span style="color: #008000;">(</span><span style="color: #008000;">)</span>
    <span style="color: #008000;">{</span>
        InitializeComponent<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">}</span>
&nbsp;
    <span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">void</span> Border_Loaded<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">object</span> sender, RoutedEventArgs e<span style="color: #008000;">)</span>
    <span style="color: #008000;">{</span>
        nameText<span style="color: #008000;">.</span><span style="color: #0000FF;">SetBinding</span><span style="color: #008000;">(</span>TextBlock<span style="color: #008000;">.</span><span style="color: #0000FF;">TextProperty</span>, NameBinding<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
        webText<span style="color: #008000;">.</span><span style="color: #0000FF;">SetBinding</span><span style="color: #008000;">(</span>HyperlinkButton<span style="color: #008000;">.</span><span style="color: #0000FF;">ContentProperty</span>, WebBinding<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
        webText<span style="color: #008000;">.</span><span style="color: #0000FF;">SetBinding</span><span style="color: #008000;">(</span>HyperlinkButton<span style="color: #008000;">.</span><span style="color: #0000FF;">NavigateUriProperty</span>, WebBinding<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
        companyText<span style="color: #008000;">.</span><span style="color: #0000FF;">SetBinding</span><span style="color: #008000;">(</span>TextBlock<span style="color: #008000;">.</span><span style="color: #0000FF;">TextProperty</span>, CompanyBinding<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
        emailText<span style="color: #008000;">.</span><span style="color: #0000FF;">SetBinding</span><span style="color: #008000;">(</span>TextBlock<span style="color: #008000;">.</span><span style="color: #0000FF;">TextProperty</span>, EmailBinding<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">}</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>The four bindings are exposed as CLR properties. When the UI is Loaded, we use them to bind the various elements within the control. The net result is that we now have a re-useable control whilst maintaining the flexibility provided by the binding framework, as illustrated by its usage below:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:ContactDetailsControl</span></span>
<span style="color: #009900;">    <span style="color: #000066;">NameBinding</span>=<span style="color: #ff0000;">"{Binding FullName}"</span></span>
<span style="color: #009900;">    <span style="color: #000066;">WebBinding</span>=<span style="color: #ff0000;">"{Binding Website}"</span></span>
<span style="color: #009900;">    <span style="color: #000066;">CompanyBinding</span>=<span style="color: #ff0000;">"{Binding Company}"</span></span>
<span style="color: #009900;">    <span style="color: #000066;">EmailBinding</span>=<span style="color: #ff0000;">"{Binding Email}"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span></pre></td></tr></table></div><p>Now for another example and a bit more fun …</p><div id="slPluginHost"> <object id="SilverlightPlugin" width="200" height="200" data="data:application/x-silverlight," type="application/x-silverlight-2"><param name="source" value="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2009/06/slbindingproperties.xap" /><a href="http://go.microsoft.com/fwlink/?LinkID=124807" style="text-decoration: none;"> <img src="http://go.microsoft.com/fwlink/?LinkId=108181" alt="Get Microsoft Silverlight" style="border-style: none;" /></a></object></div><p>The above Silverlight application shows a number of particles exhibiting <a href="http://en.wikipedia.org/wiki/Brownian_motion">Brownian motion</a>. </p><p>This application creates 50 instances of a Particle object within an ObservableCollection:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> Particle <span style="color: #008000;">:</span> INotifyPropertyChanged
<span style="color: #008000;">{</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">double</span> XLocation <span style="color: #008000;">{</span> <span style="color: #008000;">...</span> <span style="color: #008000;">}</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">double</span> YLocation <span style="color: #008000;">{</span> <span style="color: #008000;">...</span> <span style="color: #008000;">}</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">double</span> Excitement <span style="color: #008000;">{</span> <span style="color: #008000;">...</span> <span style="color: #008000;">}</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>The particles are rendered by a ScatterControl, which is a UserControl:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Border</span> <span style="color: #000066;">BorderBrush</span>=<span style="color: #ff0000;">"LightGray"</span> <span style="color: #000066;">BorderThickness</span>=<span style="color: #ff0000;">"1"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #808080; font-style: italic;">&lt;!-- ItemsSource property set in code-behind --&gt;</span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:ScatterControl</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">"scatterControl"</span></span>
<span style="color: #009900;">                      <span style="color: #000066;">XValueBinding</span>=<span style="color: #ff0000;">"{Binding Path=XLocation}"</span></span>
<span style="color: #009900;">                      <span style="color: #000066;">YValueBinding</span>=<span style="color: #ff0000;">"{Binding Path=YLocation}"</span></span>
<span style="color: #009900;">                      <span style="color: #000066;">FillBinding</span>=<span style="color: #ff0000;">"{Binding Path=Excitement,</span>
<span style="color: #009900;">                            Converter={StaticResource FillConverter}}"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Border<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div><p>This control has an ItemsSource property of type IEnumerable, and exposes three other properties of type Binding.</p><p>The markup for this control is given below:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;UserControl</span> ... <span style="color: #000000; font-weight: bold;">&gt;</span></span>
&nbsp;
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;ItemsControl</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">"itemsControl"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;ItemsControl.ItemsPanel<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;ItemsPanelTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Canvas</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/ItemsPanelTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/ItemsControl.ItemsPanel<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;ItemsControl.ItemTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;DataTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Canvas<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Ellipse</span> <span style="color: #000066;">Width</span>=<span style="color: #ff0000;">"10"</span> <span style="color: #000066;">Height</span>=<span style="color: #ff0000;">"10"</span> <span style="color: #000066;">Fill</span>=<span style="color: #ff0000;">"Red"</span></span>
<span style="color: #009900;">                             <span style="color: #000066;">Loaded</span>=<span style="color: #ff0000;">"Ellipse_Loaded"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Canvas<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/DataTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/ItemsControl.ItemTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/ItemsControl<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>    
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/UserControl<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div><p>The particles are rendered using an ItemsControl, which creates an instance of an Ellipse for each bound particle and places it within a Canvas (As defined by the ItemsControl.ItemsPanel property). As each ellipse is loaded, we set the bindings in code-behind:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">void</span> Ellipse_Loaded<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">object</span> sender, RoutedEventArgs e<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
    Ellipse ellipse <span style="color: #008000;">=</span> sender <span style="color: #0600FF; font-weight: bold;">as</span> Ellipse<span style="color: #008000;">;</span>
    ellipse<span style="color: #008000;">.</span><span style="color: #0000FF;">SetBinding</span><span style="color: #008000;">(</span>Canvas<span style="color: #008000;">.</span><span style="color: #0000FF;">LeftProperty</span>, XValueBinding<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    ellipse<span style="color: #008000;">.</span><span style="color: #0000FF;">SetBinding</span><span style="color: #008000;">(</span>Canvas<span style="color: #008000;">.</span><span style="color: #0000FF;">TopProperty</span>, YValueBinding<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    ellipse<span style="color: #008000;">.</span><span style="color: #0000FF;">SetBinding</span><span style="color: #008000;">(</span>Ellipse<span style="color: #008000;">.</span><span style="color: #0000FF;">FillProperty</span>, FillBinding<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>Again, by exposing Bindings as properties this user control is just as flexible as if its markup was included in the page directly. This example also illustrates another interesting point, the Bindings that the client provided have been re-used for each Ellipse that was created by the ItemsControl. This is made possible because when SetBinding is invoked on our Ellipse, the Binding is not associated with the Ellipse, rather, it is used to create an instance of a <a href="http://msdn.microsoft.com/en-us/library/system.windows.data.bindingexpression(VS.85).aspx">BindingExpression</a>. Binding is used to declare a binding, whereas BindingExpression is the implementation, i.e. it does the heavy-lifting of copying data to-and-from from source to target (and vice-versa).</p><p>You can download the full source for both examples: <a href="{{ site.url }}/blog/colin/wp-content/uploads/2009/06/bindingproperties.zip">bindingproperties.zip</a></p><p>Regards, Colin E.</p></div>