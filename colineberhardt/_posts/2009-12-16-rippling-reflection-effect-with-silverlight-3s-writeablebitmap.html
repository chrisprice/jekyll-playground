---
author: Colin Eberhardt
tags: WriteableBitmap
permalink: /blog/colin/2009/12/rippling-reflection-effect-with-silverlight-3s-writeablebitmap/index.html
layout: colineberhardt-blog
---
<div class="entry"><div class="topsy_widget_data topsy_theme_light-green" style="float: right; margin-left: 0.75em; background: url(data:,%7B%20%22url%22%3A%20%22http%253A%252F%252Fwww.scottlogic.co.uk%252Fblog%252Fcolin%252F2009%252F12%252Frippling-reflection-effect-with-silverlight-3s-writeablebitmap%252F%22%2C%20%22style%22%3A%20%22big%22%2C%20%22title%22%3A%20%22Rippling%20Reflection%20Effect%20with%20Silverlight%203%27s%20WriteableBitmap%20%23%22%20%7D);"></div><p><em>This blog post demonstrates how Silvelight 3′s WriteableBitmap can be used to create a UserControl that renders the content of any other Framework Element as a reflection with an animated ripple effect</em></p><div id="slPluginHost1"> <object id="SilverlightPlugin1" width="320" height="260" data="data:application/x-silverlight," type="application/x-silverlight-2"><param name="source" value="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2009/12/SilverlightShimmerOne.zip" /><a href="http://go.microsoft.com/fwlink/?LinkID=124807" style="text-decoration: none;"> <img src="http://go.microsoft.com/fwlink/?LinkId=108181" alt="Get Microsoft Silverlight" style="border-style: none;" /></a></object></div><p>I was sad to hear the news earlier this year that Yahoo! was <a href="http://news.bbc.co.uk/1/hi/8016211.stm">pulling the plug on GeoCities</a>. Somewhere buried deep within GeoCities is the first web page I ever created, complete with “Under Construction” banner, animated GIFs, guestbooks, and nasty background music. Unfortunately, I have no idea what the URL for that page was, and this is long before Google ran my life!</p><p>This blog post is a tribute to one of the many dynamic effects that were popular in the 90′s, animated reflections. These <a href="http://javaboutique.internet.com/Lake/">Java applets</a> were quite popular for a while, but have gone the same way as GeoCities. Perhaps it is time for a revival?</p><p>The Silverlight application shown above contains a <code>UserControl</code> which renders an animated reflection of a referenced <code>FrameworkElement</code>.</p><p>The code which produces the ripple is very simple, A <code>DispatcherTimer</code> increments <code>_time</code> and redraws the reflection. The reflection itself is achieved by constructing a <code>WriteableBitmap</code> from the referenced element, allowing us to grab its pixel values. Another <code>WriteableBitmap</code> is constructed for the reflection image, and rows of pixels are copied across with a suitable Y offset to produce the ripple effect:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">double</span> _time <span style="color: #008000;">=</span> <span style="color: #FF0000;">0.0</span><span style="color: #008000;">;</span>
&nbsp;
<span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">void</span> Timer_Tick<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">object</span> sender, EventArgs e<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
    <span style="color: #008080; font-style: italic;">// increment phi and update the reflection</span>
    _time <span style="color: #008000;">+=</span> <span style="color: #FF0000;">0.4</span><span style="color: #008000;">;</span>
    UpdateReflection<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// Copies an inverted image of the referenced FrameworkElement</span>
<span style="color: #008080; font-style: italic;">/// with a 'ripple' effect</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">void</span> UpdateReflection<span style="color: #008000;">(</span><span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
    FrameworkElement reflectedFE <span style="color: #008000;">=</span> ReflectedElement <span style="color: #0600FF; font-weight: bold;">as</span> FrameworkElement<span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">(</span>reflectedFE <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">)</span>
        <span style="color: #0600FF; font-weight: bold;">return</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// synchronize the element width</span>
    Width <span style="color: #008000;">=</span> reflectedFE<span style="color: #008000;">.</span><span style="color: #0000FF;">ActualWidth</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// copy the source into a writeable bitmap</span>
    WriteableBitmap sourceBitmap <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> WriteableBitmap<span style="color: #008000;">(</span>reflectedFE, <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// create a target which is the same width / height as the reflection element</span>
    WriteableBitmap targetBitmap <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> WriteableBitmap<span style="color: #008000;">(</span><span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">)</span>ActualWidth, <span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">)</span>ActualHeight<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// copy the reflection</span>
    <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">int</span> y <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> y <span style="color: #008000;">&lt;</span> targetBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">PixelHeight</span><span style="color: #008000;">;</span> y<span style="color: #008000;">++</span><span style="color: #008000;">)</span>
    <span style="color: #008000;">{</span>
        <span style="color: #6666cc; font-weight: bold;">double</span> amplitude <span style="color: #008000;">=</span> ComputeAmplitude<span style="color: #008000;">(</span>y, targetBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">PixelHeight</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
        <span style="color: #6666cc; font-weight: bold;">double</span> sinusoid <span style="color: #008000;">=</span> ComputeRipple<span style="color: #008000;">(</span>y, targetBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">PixelHeight</span>, _time<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
        <span style="color: #008080; font-style: italic;">// the offset to the y value index caused by the ripple</span>
        <span style="color: #6666cc; font-weight: bold;">int</span> yOffset <span style="color: #008000;">=</span> <span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">)</span><span style="color: #008000;">(</span>sinusoid <span style="color: #008000;">*</span> amplitude<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
        <span style="color: #008080; font-style: italic;">// compute the Y position of the line to copy from the source image</span>
        <span style="color: #6666cc; font-weight: bold;">int</span> sourceYLocation <span style="color: #008000;">=</span> sourceBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">PixelHeight</span> <span style="color: #008000;">-</span> <span style="color: #FF0000;">1</span> <span style="color: #008000;">-</span>
            <span style="color: #008000;">(</span><span style="color: #008000;">(</span>y <span style="color: #008000;">+</span> yOffset<span style="color: #008000;">)</span> <span style="color: #008000;">*</span> sourceBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">PixelHeight</span><span style="color: #008000;">)</span> <span style="color: #008000;">/</span> targetBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">PixelHeight</span><span style="color: #008000;">;</span>
&nbsp;
        <span style="color: #008080; font-style: italic;">// check that this value is in range</span>
        sourceYLocation <span style="color: #008000;">=</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Min</span><span style="color: #008000;">(</span>sourceBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">PixelHeight</span> <span style="color: #008000;">-</span> <span style="color: #FF0000;">1</span>, Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Max</span><span style="color: #008000;">(</span><span style="color: #FF0000;">0</span>, sourceYLocation<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
        <span style="color: #008080; font-style: italic;">// copy the required row</span>
        <span style="color: #6666cc; font-weight: bold;">int</span> sourceIndex <span style="color: #008000;">=</span> sourceYLocation <span style="color: #008000;">*</span> sourceBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">PixelWidth</span><span style="color: #008000;">;</span>
        <span style="color: #6666cc; font-weight: bold;">int</span> targetIndex <span style="color: #008000;">=</span> y <span style="color: #008000;">*</span> targetBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">PixelWidth</span><span style="color: #008000;">;</span>
        <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">int</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;</span> targetBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">PixelWidth</span><span style="color: #008000;">;</span> i<span style="color: #008000;">++</span><span style="color: #008000;">)</span>
        <span style="color: #008000;">{</span>
            targetBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">Pixels</span><span style="color: #008000;">[</span>targetIndex<span style="color: #008000;">++</span><span style="color: #008000;">]</span> <span style="color: #008000;">=</span> sourceBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">Pixels</span><span style="color: #008000;">[</span>sourceIndex<span style="color: #008000;">++</span><span style="color: #008000;">]</span><span style="color: #008000;">;</span>
        <span style="color: #008000;">}</span>                
    <span style="color: #008000;">}</span>
&nbsp;
    targetBitmap<span style="color: #008000;">.</span><span style="color: #0000FF;">Invalidate</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
    LayoutRoot<span style="color: #008000;">.</span><span style="color: #0000FF;">Source</span> <span style="color: #008000;">=</span> targetBitmap<span style="color: #008000;">;</span>
<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// Compute the amplitude of the oscillations at a given Y position</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">double</span> ComputeAmplitude<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">int</span> y, <span style="color: #6666cc; font-weight: bold;">int</span> height<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
    <span style="color: #008080; font-style: italic;">// our amplitude range is 1 to 3</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">(</span><span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">)</span>y <span style="color: #008000;">*</span> <span style="color: #FF0000;">2</span><span style="color: #008000;">)</span> <span style="color: #008000;">/</span> <span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">)</span>height <span style="color: #008000;">+</span> <span style="color: #FF0000;">1.0</span><span style="color: #008000;">;</span>
<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// Compute the sinusoid applied to teh image at the given location</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">double</span> ComputeRipple<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">int</span> y, <span style="color: #6666cc; font-weight: bold;">int</span> height, <span style="color: #6666cc; font-weight: bold;">double</span> time<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
    <span style="color: #008080; font-style: italic;">// provide a ripple that is the combination of two out of phase sine waves</span>
    <span style="color: #6666cc; font-weight: bold;">double</span> phaseFactor <span style="color: #008000;">=</span> <span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">)</span>y <span style="color: #008000;">/</span> <span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">)</span>height<span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Sin</span><span style="color: #008000;">(</span>time <span style="color: #008000;">+</span> phaseFactor <span style="color: #008000;">*</span> <span style="color: #FF0000;">16</span><span style="color: #008000;">)</span> <span style="color: #008000;">+</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Sin</span><span style="color: #008000;">(</span>time <span style="color: #008000;">+</span> phaseFactor <span style="color: #008000;">*</span> <span style="color: #FF0000;">30</span><span style="color: #008000;">)</span>
        <span style="color: #008000;">+</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Sin</span><span style="color: #008000;">(</span>time <span style="color: #008000;">+</span> phaseFactor <span style="color: #008000;">*</span> <span style="color: #FF0000;">62</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>The XAML for this user control is simply an image with an opacity gradient:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;UserControl</span> <span style="color: #000066;">x:Class</span>=<span style="color: #ff0000;">"SilverlightShimmer.ReflectionControl"</span></span>
<span style="color: #009900;">    <span style="color: #000066;">xmlns</span>=<span style="color: #ff0000;">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span> </span>
<span style="color: #009900;">    <span style="color: #000066;">xmlns:x</span>=<span style="color: #ff0000;">"http://schemas.microsoft.com/winfx/2006/xaml"</span> </span>
<span style="color: #009900;">    <span style="color: #000066;">Width</span>=<span style="color: #ff0000;">"300"</span> <span style="color: #000066;">Height</span>=<span style="color: #ff0000;">"300"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Image</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">"LayoutRoot"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Image.OpacityMask<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;LinearGradientBrush</span> <span style="color: #000066;">EndPoint</span>=<span style="color: #ff0000;">"0.5,1"</span> <span style="color: #000066;">StartPoint</span>=<span style="color: #ff0000;">"0.5,0"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;GradientStop</span> <span style="color: #000066;">Color</span>=<span style="color: #ff0000;">"#FF000000"</span> <span style="color: #000066;">Offset</span>=<span style="color: #ff0000;">"0"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;GradientStop</span> <span style="color: #000066;">Color</span>=<span style="color: #ff0000;">"#00000000"</span> <span style="color: #000066;">Offset</span>=<span style="color: #ff0000;">"1"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/LinearGradientBrush<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Image.OpacityMask<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Image<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/UserControl<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div><p>This control is associated with our Christmas-ey image as follows:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;UserControl</span> <span style="color: #000066;">x:Class</span>=<span style="color: #ff0000;">"SilverlightShimmer.MainPage"</span></span>
<span style="color: #009900;">    <span style="color: #000066;">xmlns</span>=<span style="color: #ff0000;">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></span>
<span style="color: #009900;">    <span style="color: #000066;">xmlns:x</span>=<span style="color: #ff0000;">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span>
<span style="color: #009900;">    <span style="color: #000066;">xmlns:local</span>=<span style="color: #ff0000;">"clr-namespace:SilverlightShimmer"</span> <span style="color: #000066;">Width</span>=<span style="color: #ff0000;">"320"</span> <span style="color: #000066;">Height</span>=<span style="color: #ff0000;">"260"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
&nbsp;
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Grid</span> <span style="color: #000066;">Background</span>=<span style="color: #ff0000;">"Black"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
&nbsp;
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;StackPanel</span> <span style="color: #000066;">Orientation</span>=<span style="color: #ff0000;">"Vertical"</span> <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"10"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>            
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Border</span>  <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">"controlToReflect"</span> <span style="color: #000066;">BorderThickness</span>=<span style="color: #ff0000;">"5"</span> <span style="color: #000066;">BorderBrush</span>=<span style="color: #ff0000;">"LightGray"</span></span>
<span style="color: #009900;">                     <span style="color: #000066;">CornerRadius</span>=<span style="color: #ff0000;">"3"</span> <span style="color: #000066;">HorizontalAlignment</span>=<span style="color: #ff0000;">"Center"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Image</span>  <span style="color: #000066;">Source</span>=<span style="color: #ff0000;">"christmas.jpg"</span> <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"3"</span></span>
<span style="color: #009900;">                        <span style="color: #000066;">Stretch</span>=<span style="color: #ff0000;">"None"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Border<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:ReflectionControl</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">"shimmer"</span> <span style="color: #000066;">Height</span>=<span style="color: #ff0000;">"80"</span> <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"3"</span></span>
<span style="color: #009900;">                       <span style="color: #000066;">ReflectedElement</span>=<span style="color: #ff0000;">"{Binding ElementName=controlToReflect}"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/StackPanel<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Grid<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/UserControl<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div><p>One interesting point here is the way in which the <code>Border</code> and <code>Image</code> are associated with the <code>ReflectionControl</code>. The <code>ReflectedElement</code> property is bound to the <code>Border</code> via an <code>ElementName</code> binding, however this binding has no <code>Path</code>. Therefore, rather than binding to a property of the referenced element, the <code>ReflectedElement</code> is bound to the element itself. Hence, no need for any code behind to associated the <code>ReflectionControl</code> with the element(s) to render.</p><p>This control can be used to render a reflection of anything (even a reflection of a reflection if you so wish). Here is a more complex example:</p><div id="slPluginHost2"> <object id="SilverlightPlugin2" width="450" height="310" data="data:application/x-silverlight," type="application/x-silverlight-2"><param name="source" value="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2009/12/SilverlightShimmerTwo.zip" /><a href="http://go.microsoft.com/fwlink/?LinkID=124807" style="text-decoration: none;"> <img src="http://go.microsoft.com/fwlink/?LinkId=108181" alt="Get Microsoft Silverlight" style="border-style: none;" /></a></object></div><p>You can download the full sourcecode here: <a href="{{ site.url }}/blog/colin/wp-content/uploads/2009/12/SilverlightShimmer.zip">SilverlightShimmer.zip</a></p><p>Regards, Colin E.</p></div>