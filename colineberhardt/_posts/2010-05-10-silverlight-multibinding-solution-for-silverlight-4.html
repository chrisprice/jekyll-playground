---
author: Colin Eberhardt
tags: binding, multibinding, silverlight
permalink: /blog/colin/2010/05/silverlight-multibinding-solution-for-silverlight-4/index.html
layout: colineberhardt-blog
---
<div class="entry"><div class="topsy_widget_data topsy_theme_light-green" style="float: right; margin-left: 0.75em; background: url(data:,%7B%20%22url%22%3A%20%22http%253A%252F%252Fwww.scottlogic.co.uk%252Fblog%252Fcolin%252F2010%252F05%252Fsilverlight-multibinding-solution-for-silverlight-4%252F%22%2C%20%22style%22%3A%20%22big%22%2C%20%22title%22%3A%20%22Silverlight%20MultiBinding%20solution%20for%20Silverlight%204%20%23%22%20%7D);"></div><p><em>In this post I describe an update to the Silverlight MultiBinding solution I presented last year. This update includes support for Silverlight 4, attached properties and multiple bindings on a single object.</em></p><p><b>UPDATE:</b> I have updated this code to include ElementName and TwoWay binding. <a href="{{ site.url }}/blog/colin/2010/08/silverlight-multibinding-updated-adding-support-for-elementname-and-twoway-binding/">Grab the latest copy here</a>.</p><p>MultiBinding is a WPF feature that allows you to bind a single property to a number of sources, with the source values being combined by a value converter. This is a feature that is missing from Silverlight. About a year ago I developed a <a href="{{ site.url }}/blog/colin/2009/06/silverlight-multibindings-how-to-attached-mutiple-bindings-to-a-single-property/">MultiBinding solution for Silverlight</a>, which has proven very popular! I even had an email from an Microsoft Attorney asking if they could use it in the <a href="http://www.silverlight.net/content/samples/apps/facebookclient/sfcquickinstall.aspx">Silverlight Facebook client</a> (How cool is that <img src="http://www.scottlogic.co.uk/blog/colin/wp-includes/images/smilies/icon_smile.gif" alt=":-)" class="wp-smiley" />  ). I was also very happy when <a href="http://http://www.olsonsoft.com/blogs/stefanolson/">Stefan Olson</a> made a few updates to this code to allow multiple MultiBindings on a single object and spotted the SL4 issue. This blog post is a quick demonstration of these new features …</p><p>The following application is an example of MultiBindings in action:</p><div id="slPluginHost"> <object id="SilverlightPlugin" width="200" height="150" data="data:application/x-silverlight," type="application/x-silverlight-2"><param name="source" value="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2010/05/SLMultiBinding.xap" /><a href="http://go.microsoft.com/fwlink/?LinkID=149156" style="text-decoration: none;"> <img src="http://go.microsoft.com/fwlink/?LinkId=108181" alt="Get Microsoft Silverlight" style="border-style: none;" /></a></object></div><p>In the above application, the TextBox at the top of the page is bound to both the surname and forename properties of our data-object via converter that takes the first letter of the forename and the surname. If you edit the surname or forename (hitting enter or changing focus to commit), the title is updated automatically. The title tooltip is bound to the all three object properties via a different value converter that  concatenates all three.</p><p>The XAML for this binding is show below:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">"Block"</span> <span style="color: #000066;">Foreground</span>=<span style="color: #ff0000;">"White"</span> <span style="color: #000066;">FontSize</span>=<span style="color: #ff0000;">"13"</span> <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"5,0,0,0"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:BindingUtil.MultiBindings<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:MultiBindings<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:MultiBinding</span> <span style="color: #000066;">TargetProperty</span>=<span style="color: #ff0000;">"Text"</span></span>
<span style="color: #009900;">                                <span style="color: #000066;">Converter</span>=<span style="color: #ff0000;">"{StaticResource TitleSummaryConverter}"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:MultiBinding.Bindings<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:BindingCollection<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Binding</span> <span style="color: #000066;">Path</span>=<span style="color: #ff0000;">"Surname"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>                            
                        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Binding</span> <span style="color: #000066;">Path</span>=<span style="color: #ff0000;">"Forename"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:BindingCollection<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:MultiBinding.Bindings<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:MultiBinding<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:MultiBinding</span> <span style="color: #000066;">TargetProperty</span>=<span style="color: #ff0000;">"ToolTipService.ToolTip"</span></span>
<span style="color: #009900;">                                <span style="color: #000066;">Converter</span>=<span style="color: #ff0000;">"{StaticResource TitleConverter}"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:MultiBinding.Bindings<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:BindingCollection<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Binding</span> <span style="color: #000066;">Path</span>=<span style="color: #ff0000;">"Surname"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>                            
                        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Binding</span> <span style="color: #000066;">Path</span>=<span style="color: #ff0000;">"Forename"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Binding</span> <span style="color: #000066;">Path</span>=<span style="color: #ff0000;">"Age"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
                    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:BindingCollection<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
                <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:MultiBinding.Bindings<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:MultiBinding<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:MultiBindings<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:BindingUtil.MultiBindings<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/TextBlock<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div><p>In the above you can see that our TextBlock has two multibindings, one on Forename and Surname, and the other which includes all three properties. Note, the second multibinding is on the ToolTipService.ToolTip attached property.</p><p>You can download the source for Silverlight MultiBinding here: <a href="{{ site.url }}/blog/colin/wp-content/uploads/2010/05/SLMultiBindingUpdate.zip">SLMultiBindingUpdate.zip</a> – thanks again to Stefan Olson who added WPF support to this technique.</p><p>If you are interested in the technical details of how this works, I refer you to the <a href="{{ site.url }}/blog/colin/2009/06/silverlight-multibindings-how-to-attached-mutiple-bindings-to-a-single-property/">original article</a> which describes how the code builds a ‘virtual’ branch on the visual tree in order to evaluate your bindings:</p><p><a href="{{ site.url }}/blog/colin/wp-content/uploads/2009/06/virtualbranch.png"><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2009/06/virtualbranch.png" alt="" title="virtualbranch" width="604" height="394" class="aligncenter size-full wp-image-355" /></a></p><p>I hope this update is of use to SL4 developers. If you have any feedback, please leave a comment below.</p><p>You can download the source for Silverlight MultiBinding here: <a href="{{ site.url }}/blog/colin/wp-content/uploads/2010/05/SLMultiBindingUpdate.zip">SLMultiBindingUpdate.zip</a></p><p>Regards, Colin E.</p></div>