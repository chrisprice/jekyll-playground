---
author: Colin Eberhardt
tags: 
permalink: /blog/colin/2009/09/helpful-extension-methods-for-show-hide-animations-in-silverlight/index.html
layout: colineberhardt-blog
---
<div class="entry"><div class="topsy_widget_data topsy_theme_light-green" style="float: right; margin-left: 0.75em; background: url(data:,%7B%20%22url%22%3A%20%22http%253A%252F%252Fwww.scottlogic.co.uk%252Fblog%252Fcolin%252F2009%252F09%252Fhelpful-extension-methods-for-show-hide-animations-in-silverlight%252F%22%2C%20%22style%22%3A%20%22big%22%2C%20%22title%22%3A%20%22Helpful%20extension%20methods%20for%20Show%20%2F%20Hide%20animations%20in%20Silverlight%20%23%22%20%7D);"></div><p><em>Today’s blog post is a couple of very simple utility methods that I have found myself using again and again …</em></p><p>The animations that Silverlight developers have at their disposal are both varied and powerful. It is easy to get carried away and cover your application with gratuitous animations, which soon become an unwanted distraction. However, animation, when used sparingly, can make the user experience (much as I hate buzzwords, this one seems to have stuck!) smoother and more fluid. One class of animation which I think adds to program fluidity is ones used for showing / hiding parts of the user interface. </p><p>With Silvelight, the typical process for animation is to create a storyboard in XAML that animates the element being shown / hidden. This storyboard is looked-up in the resources and triggered at the right moment. The typical code looks something like this:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;">Storyboard anim <span style="color: #008000;">=</span> layourRoot<span style="color: #008000;">.</span><span style="color: #0000FF;">Resources</span><span style="color: #008000;">[</span><span style="color: #666666;">"myAnimation"</span><span style="color: #008000;">]</span> <span style="color: #0600FF; font-weight: bold;">as</span> Storyboard<span style="color: #008000;">;</span>
anim<span style="color: #008000;">.</span><span style="color: #0000FF;">Begin</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span></pre></td></tr></table></div><p>It’s a pretty simple peice of code, however, if you have multiple elements being shown / hidden, the management of resource names, and repeated code is a bit of a pain. </p><p>As an alternative I have written a couple of very simple extension methods to <code>FrameworkElement</code>, as shown below:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// Shows the element, playing a storyboard if one is present</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// &lt;param name="element"&gt;&lt;/param&gt;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Show<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">this</span> FrameworkElement element<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
    <span style="color: #6666cc; font-weight: bold;">string</span> animationName <span style="color: #008000;">=</span> element<span style="color: #008000;">.</span><span style="color: #0000FF;">Name</span> <span style="color: #008000;">+</span> <span style="color: #666666;">"ShowAnim"</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// check for presence of a show animation</span>
    Storyboard showAnim <span style="color: #008000;">=</span> element<span style="color: #008000;">.</span><span style="color: #0000FF;">Resources</span><span style="color: #008000;">[</span>animationName<span style="color: #008000;">]</span> <span style="color: #0600FF; font-weight: bold;">as</span> Storyboard<span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">(</span>showAnim <span style="color: #008000;">!=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">)</span>
    <span style="color: #008000;">{</span>
        showAnim<span style="color: #008000;">.</span><span style="color: #0000FF;">Begin</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">}</span>
    <span style="color: #0600FF; font-weight: bold;">else</span>
    <span style="color: #008000;">{</span>
        element<span style="color: #008000;">.</span><span style="color: #0000FF;">Visibility</span> <span style="color: #008000;">=</span> Visibility<span style="color: #008000;">.</span><span style="color: #0000FF;">Visible</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// Hides the element, playing a storyboard if one is present</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// &lt;param name="element"&gt;&lt;/param&gt;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Hide<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">this</span> FrameworkElement element<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
    <span style="color: #6666cc; font-weight: bold;">string</span> animationName <span style="color: #008000;">=</span> element<span style="color: #008000;">.</span><span style="color: #0000FF;">Name</span> <span style="color: #008000;">+</span> <span style="color: #666666;">"HideAnim"</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// check for presence of a hide animation</span>
    Storyboard showAnim <span style="color: #008000;">=</span> element<span style="color: #008000;">.</span><span style="color: #0000FF;">Resources</span><span style="color: #008000;">[</span>animationName<span style="color: #008000;">]</span> <span style="color: #0600FF; font-weight: bold;">as</span> Storyboard<span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">(</span>showAnim <span style="color: #008000;">!=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">)</span>
    <span style="color: #008000;">{</span>
        showAnim<span style="color: #008000;">.</span><span style="color: #0000FF;">Begin</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">}</span>
    <span style="color: #0600FF; font-weight: bold;">else</span>
    <span style="color: #008000;">{</span>
        element<span style="color: #008000;">.</span><span style="color: #0000FF;">Visibility</span> <span style="color: #008000;">=</span> Visibility<span style="color: #008000;">.</span><span style="color: #0000FF;">Collapsed</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">}</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>What each of these extension methods does is check for the presence of a <code>Storyboard</code> named <code>"ShowAnim"</code> or <code>"HideAnim"</code>, prefixed with the element name in order to ensure uniqueness. If the storyboard is present, the animation is played. Otherwise, the element visibility is set directly. This is a very useful feature, in that the <code>Show() </code>and<code> Hide()</code> extension methods can be used if you want to change an elements visibility without animation. If, at a  later date, you then decide that you want this change in visibility to be animated, you simple add a storyboard to the XAML, without having to change the code. </p><p>Here is a simple example based on a <a href="{{ site.url }}/blog/colin/2009/03/adding-a-location-crosshair-to-silverlight-charts-again/">previous blog post of mine</a>:</p><div id="slPluginHost"> <object id="SilverlightPlugin" width="400" height="300" data="data:application/x-silverlight," type="application/x-silverlight-2"><param name="source" value="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2009/09/SLLineChartCrossHair.xap" /><a href="http://go.microsoft.com/fwlink/?LinkID=124807" style="text-decoration: none;"> <img src="http://go.microsoft.com/fwlink/?LinkId=108181" alt="Get Microsoft Silverlight" style="border-style: none;" /></a></object></div><p>Here is a XAML snippet from the example:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;">...
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Grid</span> <span style="color: #000066;">Name</span>=<span style="color: #ff0000;">"Crosshair"</span> <span style="color: #000066;">Opacity</span>=<span style="color: #ff0000;">"0"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Grid.Resources<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Storyboard</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">"CrosshairShowAnim"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;DoubleAnimation</span> <span style="color: #000066;">Storyboard.TargetName</span>=<span style="color: #ff0000;">"Crosshair"</span> </span>
<span style="color: #009900;">                        <span style="color: #000066;">Storyboard.TargetProperty</span>=<span style="color: #ff0000;">"(UIElement.Opacity)"</span></span>
<span style="color: #009900;">                        <span style="color: #000066;">To</span>=<span style="color: #ff0000;">"1"</span>  <span style="color: #000066;">Duration</span>=<span style="color: #ff0000;">"00:00:00.1"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Storyboard<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Storyboard</span> <span style="color: #000066;">x:Name</span>=<span style="color: #ff0000;">"CrosshairHideAnim"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;DoubleAnimation</span> <span style="color: #000066;">Storyboard.TargetName</span>=<span style="color: #ff0000;">"Crosshair"</span>                        </span>
<span style="color: #009900;">                        <span style="color: #000066;">Storyboard.TargetProperty</span>=<span style="color: #ff0000;">"(UIElement.Opacity)"</span></span>
<span style="color: #009900;">                        <span style="color: #000066;">Duration</span>=<span style="color: #ff0000;">"00:00:00.1"</span> <span style="color: #000066;">To</span>=<span style="color: #ff0000;">"0"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Storyboard<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Grid.Resources<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Line</span> <span style="color: #000066;">Name</span>=<span style="color: #ff0000;">"Vertical"</span> <span style="color: #000066;">X1</span>=<span style="color: #ff0000;">"{Binding Path=X}"</span> <span style="color: #000066;">Y1</span>=<span style="color: #ff0000;">"0"</span></span>
<span style="color: #009900;">          <span style="color: #000066;">X2</span>=<span style="color: #ff0000;">"{Binding Path=X}"</span> <span style="color: #000066;">Y2</span>=<span style="color: #ff0000;">"400"</span> <span style="color: #000066;">Stroke</span>=<span style="color: #ff0000;">"Black"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Line</span> <span style="color: #000066;">Name</span>=<span style="color: #ff0000;">"Horizontal"</span> <span style="color: #000066;">X1</span>=<span style="color: #ff0000;">"0"</span> <span style="color: #000066;">Y1</span>=<span style="color: #ff0000;">"{Binding Path=Y}"</span></span>
<span style="color: #009900;">          <span style="color: #000066;">X2</span>=<span style="color: #ff0000;">"400"</span> <span style="color: #000066;">Y2</span>=<span style="color: #ff0000;">"{Binding Path=Y}"</span> <span style="color: #000066;">Stroke</span>=<span style="color: #ff0000;">"Black"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Grid<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
...</pre></td></tr></table></div><p>Note the storyboard name is prefixed with the element name. And here is how this animation, and the legend’s, is triggered from code:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">void</span> CrosshairContainer_MouseEnter<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">object</span> sender, MouseEventArgs e<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
    LocationIndicator<span style="color: #008000;">.</span><span style="color: #0000FF;">Show</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    Crosshair<span style="color: #008000;">.</span><span style="color: #0000FF;">Show</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    ChartRoot<span style="color: #008000;">.</span><span style="color: #0000FF;">Cursor</span> <span style="color: #008000;">=</span> Cursors<span style="color: #008000;">.</span><span style="color: #0000FF;">None</span><span style="color: #008000;">;</span>
<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">void</span> CrosshairContainer_MouseLeave<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">object</span> sender, MouseEventArgs e<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
    LocationIndicator<span style="color: #008000;">.</span><span style="color: #0000FF;">Hide</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    Crosshair<span style="color: #008000;">.</span><span style="color: #0000FF;">Hide</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    ChartRoot<span style="color: #008000;">.</span><span style="color: #0000FF;">Cursor</span> <span style="color: #008000;">=</span> Cursors<span style="color: #008000;">.</span><span style="color: #0000FF;">Arrow</span><span style="color: #008000;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>You can download the full sourcecode for the example project: <a href="{{ site.url }}/blog/colin/wp-content/uploads/2009/09/showHideAnimations.zip">showHideAnimations.zip</a>.</p><p>Regards,<br />
Colin E.</p></div>