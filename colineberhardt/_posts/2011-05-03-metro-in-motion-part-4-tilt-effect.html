---
author: Colin Eberhardt
tags: codeproject, metro, WP7
permalink: /blog/colin/2011/05/metro-in-motion-part-4-tilt-effect/index.html
layout: colineberhardt-blog
---
<div class="entry"><div class="topsy_widget_data topsy_theme_light-green" style="float: right; margin-left: 0.75em; background: url(data:,%7B%20%22url%22%3A%20%22http%253A%252F%252Fwww.scottlogic.co.uk%252Fblog%252Fcolin%252F2011%252F05%252Fmetro-in-motion-part-4-tilt-effect%252F%22%2C%20%22style%22%3A%20%22big%22%2C%20%22title%22%3A%20%22Metro%20In%20Motion%20Part%20%234%20-%20Tilt%20Effect%20%23%22%20%7D);"></div><p><i>This blog post describes the implementation of a metro ’tilt’ effect for Windows Phone 7 which causes element to respond to user interactions by tilting in 3D</i></p><p>So far in the “Metro In Motion” series I have covered <a href="{{ site.url }}/blog/colin/2011/03/metro-in-motion-fluid-list-animation/">fluid list animations</a>, <a href="{{ site.url }}/blog/colin/2011/03/metro-in-motion-part-2-peel-animations/">‘peel’ animations</a> and <a href="{{ site.url }}/blog/colin/2011/04/metro-in-motion-3-flying-titles/">flying title</a>. In this blog post I am looking at the ’tilt’ effect seen in native Windows Phone 7 applications where list items, tiles, check-boxes and other user interface element tilt slightly when the user presses them. This is a subtle 3D effect that makes the phone interface more tactile and playful.</p><p>I was in two minds about whether to implement my own tilt effect since there is an implementation of this effect available via the <a href="http://silverlight.codeplex.com/">Silverlight (for Windows Phone 7) Toolkit</a>. However, I am not that keen on the toolkit implementation of this feature. Firstly, the effect is applied by specifying the types of element that should tilt, unfortunately this fails in various scenarios; secondly, the tilt is a bit over-the-top. Personally, I think this effect works best when it is at its most subtle.</p><p>The video below shows the tilt effect in action, together with the other Metro In Motion effects:</p><p><iframe width="425" height="349" src="http://www.youtube.com/embed/GIHJfb9ksOU" frameborder="0" allowfullscreen="allowfullscreen"></iframe></p><p><br /><br />
The implementation of this effect is actually rather simple, relying heavily on the <a href="http://msdn.microsoft.com/en-us/library/system.windows.media.planeprojection%28VS.95%29.aspx"><code>PlaneProjection</code></a> transform that makes 3D transformations accessible to mere mortals like myself (for more powerful and flexible 3D effects I would thoroughly recommend René Schule’s <a href="http://matrix3dex.codeplex.com/">Matrix3DEx</a> library). The effect is added to any element by applying an attached property:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Button</span> <span style="color: #000066;">local:MetroInMotion.Tilt</span>=<span style="color: #ff0000;">"6"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span></pre></td></tr></table></div><p>The value of the <code>Tilt</code> property defines how pronounced the effect is. When the <code>Tilt</code> property is attached, event handlers are added to the UI element:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #008080; font-style: italic;">// The extent of the tilt action, the larger the number, the bigger the tilt</span>
<span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">double</span> TiltAngleFactor <span style="color: #008000;">=</span> <span style="color: #FF0000;">4</span><span style="color: #008000;">;</span>
&nbsp;
<span style="color: #008080; font-style: italic;">// The extent of the scaling action, the smaller the number, the greater the scaling.</span>
<span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">double</span> ScaleFactor <span style="color: #008000;">=</span> <span style="color: #FF0000;">100</span><span style="color: #008000;">;</span>
&nbsp;
<span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> OnTiltChanged<span style="color: #008000;">(</span>DependencyObject d,
  DependencyPropertyChangedEventArgs args<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
  FrameworkElement targetElement <span style="color: #008000;">=</span> d <span style="color: #0600FF; font-weight: bold;">as</span> FrameworkElement<span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #6666cc; font-weight: bold;">double</span> tiltFactor <span style="color: #008000;">=</span> GetTilt<span style="color: #008000;">(</span>d<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #008080; font-style: italic;">// create the required transformations</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> projection <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> PlaneProjection<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> scale <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> ScaleTransform<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> translate <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> TranslateTransform<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">var</span> transGroup <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> TransformGroup<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  transGroup<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>scale<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  transGroup<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>translate<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #008080; font-style: italic;">// associate with the target element</span>
  targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">Projection</span> <span style="color: #008000;">=</span> projection<span style="color: #008000;">;</span>
  targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">RenderTransform</span> <span style="color: #008000;">=</span> transGroup<span style="color: #008000;">;</span>
  targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">RenderTransformOrigin</span> <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> Point<span style="color: #008000;">(</span><span style="color: #FF0000;">0.5</span>, <span style="color: #FF0000;">0.5</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
  targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">MouseLeftButtonDown</span> <span style="color: #008000;">+=</span> <span style="color: #008000;">(</span>s, e<span style="color: #008000;">)</span> <span style="color: #008000;">=&gt;</span>
    <span style="color: #008000;">{</span>
      <span style="color: #0600FF; font-weight: bold;">var</span> clickPosition <span style="color: #008000;">=</span> e<span style="color: #008000;">.</span><span style="color: #0000FF;">GetPosition</span><span style="color: #008000;">(</span>targetElement<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
      <span style="color: #008080; font-style: italic;">// find the maximum of width / height</span>
      <span style="color: #6666cc; font-weight: bold;">double</span> maxDimension <span style="color: #008000;">=</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Max</span><span style="color: #008000;">(</span>targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">ActualWidth</span>, targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">ActualHeight</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
      <span style="color: #008080; font-style: italic;">// compute the normalised horizontal distance from the centre</span>
      <span style="color: #6666cc; font-weight: bold;">double</span> distanceFromCenterX <span style="color: #008000;">=</span> targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">ActualWidth</span> <span style="color: #008000;">/</span> <span style="color: #FF0000;">2</span> <span style="color: #008000;">-</span> clickPosition<span style="color: #008000;">.</span><span style="color: #0000FF;">X</span><span style="color: #008000;">;</span>
      <span style="color: #6666cc; font-weight: bold;">double</span> normalisedDistanceX <span style="color: #008000;">=</span> <span style="color: #FF0000;">2</span> <span style="color: #008000;">*</span> distanceFromCenterX <span style="color: #008000;">/</span> maxDimension<span style="color: #008000;">;</span> 
&nbsp;
      <span style="color: #008080; font-style: italic;">// rotate around the Y axis </span>
      projection<span style="color: #008000;">.</span><span style="color: #0000FF;">RotationY</span> <span style="color: #008000;">=</span> normalisedDistanceX <span style="color: #008000;">*</span> TiltAngleFactor <span style="color: #008000;">*</span> tiltFactor<span style="color: #008000;">;</span>
&nbsp;
      <span style="color: #008080; font-style: italic;">// compute the normalised vertical distance from the centre</span>
      <span style="color: #6666cc; font-weight: bold;">double</span> distanceFromCenterY <span style="color: #008000;">=</span> targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">ActualHeight</span> <span style="color: #008000;">/</span> <span style="color: #FF0000;">2</span> <span style="color: #008000;">-</span> clickPosition<span style="color: #008000;">.</span><span style="color: #0000FF;">Y</span><span style="color: #008000;">;</span>
      <span style="color: #6666cc; font-weight: bold;">double</span> normalisedDistanceY <span style="color: #008000;">=</span> <span style="color: #FF0000;">2</span> <span style="color: #008000;">*</span> distanceFromCenterY <span style="color: #008000;">/</span> maxDimension<span style="color: #008000;">;</span>
&nbsp;
      <span style="color: #008080; font-style: italic;">// rotate around the X axis, </span>
      projection<span style="color: #008000;">.</span><span style="color: #0000FF;">RotationX</span> <span style="color: #008000;">=</span> <span style="color: #008000;">-</span>normalisedDistanceY <span style="color: #008000;">*</span> TiltAngleFactor <span style="color: #008000;">*</span> tiltFactor<span style="color: #008000;">;</span>
&nbsp;
      <span style="color: #008080; font-style: italic;">// find the distance to centre</span>
      <span style="color: #6666cc; font-weight: bold;">double</span> distanceToCentre <span style="color: #008000;">=</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Sqrt</span><span style="color: #008000;">(</span>normalisedDistanceX <span style="color: #008000;">*</span> normalisedDistanceX
        <span style="color: #008000;">+</span> normalisedDistanceY <span style="color: #008000;">*</span> normalisedDistanceY<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
      <span style="color: #008080; font-style: italic;">// scale accordingly</span>
      <span style="color: #6666cc; font-weight: bold;">double</span> scaleVal <span style="color: #008000;">=</span> tiltFactor <span style="color: #008000;">*</span> <span style="color: #008000;">(</span><span style="color: #FF0000;">1</span> <span style="color: #008000;">-</span> distanceToCentre<span style="color: #008000;">)</span> <span style="color: #008000;">/</span> ScaleFactor<span style="color: #008000;">;</span>
      scale<span style="color: #008000;">.</span><span style="color: #0000FF;">ScaleX</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">1</span> <span style="color: #008000;">-</span> scaleVal<span style="color: #008000;">;</span>
      scale<span style="color: #008000;">.</span><span style="color: #0000FF;">ScaleY</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">1</span> <span style="color: #008000;">-</span> scaleVal<span style="color: #008000;">;</span>
    <span style="color: #008000;">}</span><span style="color: #008000;">;</span>
&nbsp;
  targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">ManipulationCompleted</span> <span style="color: #008000;">+=</span> <span style="color: #008000;">(</span>s, e<span style="color: #008000;">)</span> <span style="color: #008000;">=&gt;</span>
    <span style="color: #008000;">{</span>
      <span style="color: #0600FF; font-weight: bold;">var</span> sb <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> Storyboard<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
      sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateAnimation<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">null</span>, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0.1</span>, <span style="color: #666666;">"RotationY"</span>, projection<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
      sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateAnimation<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">null</span>, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0.1</span>, <span style="color: #666666;">"RotationX"</span>, projection<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
      sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateAnimation<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">null</span>, <span style="color: #FF0000;">1</span>, <span style="color: #FF0000;">0.1</span>, <span style="color: #666666;">"ScaleX"</span>, scale<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
      sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateAnimation<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">null</span>, <span style="color: #FF0000;">1</span>, <span style="color: #FF0000;">0.1</span>, <span style="color: #666666;">"ScaleY"</span>, scale<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
      sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Begin</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">}</span><span style="color: #008000;">;</span>
&nbsp;
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>When the element is clicked, the distance of the click location to the centre is computed. A <code>PlaneProjection</code> is used to tilt the element based on the click location, with a click at the top causing it to tilt around the X axis, and a click on the side tilting around the Y axis. A <code>ScaleTransform</code> is used to make the element shrink slightly, giving a user the feeling that the element has been pushed into the phone slightly.</p><p>When the manipulation is complete the properties of these various transforms are animated back to their original values using<br />
<code>CreateAnimation</code> which is a simple utility method for creating <code>DoubleAnimation</code> instances:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #0600FF; font-weight: bold;">static</span> DoubleAnimation CreateAnimation<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">?</span> <span style="color: #0600FF; font-weight: bold;">from</span>, <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">?</span> to, <span style="color: #6666cc; font-weight: bold;">double</span> duration,
  <span style="color: #6666cc; font-weight: bold;">string</span> targetProperty, DependencyObject target<span style="color: #008000;">)</span>
<span style="color: #008000;">{</span>
  <span style="color: #0600FF; font-weight: bold;">var</span> db <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> DoubleAnimation<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  db<span style="color: #008000;">.</span><span style="color: #0000FF;">To</span> <span style="color: #008000;">=</span> to<span style="color: #008000;">;</span>
  db<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">From</span> <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">from</span><span style="color: #008000;">;</span>
  db<span style="color: #008000;">.</span><span style="color: #0000FF;">EasingFunction</span> <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> SineEase<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  db<span style="color: #008000;">.</span><span style="color: #0000FF;">Duration</span> <span style="color: #008000;">=</span> TimeSpan<span style="color: #008000;">.</span><span style="color: #0000FF;">FromSeconds</span><span style="color: #008000;">(</span>duration<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  Storyboard<span style="color: #008000;">.</span><span style="color: #0000FF;">SetTarget</span><span style="color: #008000;">(</span>db, target<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  Storyboard<span style="color: #008000;">.</span><span style="color: #0000FF;">SetTargetProperty</span><span style="color: #008000;">(</span>db, <span style="color: #008000;">new</span> PropertyPath<span style="color: #008000;">(</span>targetProperty<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
  <span style="color: #0600FF; font-weight: bold;">return</span> db<span style="color: #008000;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>The magnitude of the <code>ScaleTransform</code> and <code>PlaneProjection</code> depends on the click location, with clicks to the centre of the element resulting in a scaling, but no rotation, and clicks at the edge causing rotation but no scaling. The net result can be observed below where the effect of clicking at various locations of an element is shown:</p><p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/05/tilt.png" alt="" title="tilt" width="305" height="554" class="aligncenter size-full wp-image-1431" /></p><p>You can also see the effect of clicking a square element below:</p><p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/05/tilt2.png" alt="" title="tilt2" width="305" height="554" class="aligncenter size-full wp-image-1432" /></p><p>Finally, native phone applications have another subtle effect where elements that are tilted at the bottom of the screen appear to be viewed from above, whilst ones at the top are viewed from below. This can be achieved by applying a local offset to the <code>PlaneProjection</code> and an equal and opposite vertical <code>TranslateTransform</code>. The following code is added …</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;">targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">MouseLeftButtonDown</span> <span style="color: #008000;">+=</span> <span style="color: #008000;">(</span>s, e<span style="color: #008000;">)</span> <span style="color: #008000;">=&gt;</span>
  <span style="color: #008000;">{</span>
    <span style="color: #008080; font-style: italic;">// ... scale and plane projection transforms show earlier go here ...</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// offset the plane transform</span>
    <span style="color: #0600FF; font-weight: bold;">var</span> rootElement <span style="color: #008000;">=</span> Application<span style="color: #008000;">.</span><span style="color: #0000FF;">Current</span><span style="color: #008000;">.</span><span style="color: #0000FF;">RootVisual</span> <span style="color: #0600FF; font-weight: bold;">as</span> FrameworkElement<span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">var</span> relativeToCentre <span style="color: #008000;">=</span> <span style="color: #008000;">(</span>targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">GetRelativePosition</span><span style="color: #008000;">(</span>rootElement<span style="color: #008000;">)</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Y</span> <span style="color: #008000;">-</span> rootElement<span style="color: #008000;">.</span><span style="color: #0000FF;">ActualHeight</span> <span style="color: #008000;">/</span> <span style="color: #FF0000;">2</span><span style="color: #008000;">)</span> <span style="color: #008000;">/</span> <span style="color: #FF0000;">2</span><span style="color: #008000;">;</span>
    translate<span style="color: #008000;">.</span><span style="color: #0000FF;">Y</span> <span style="color: #008000;">=</span> <span style="color: #008000;">-</span>relativeToCentre<span style="color: #008000;">;</span>
    projection<span style="color: #008000;">.</span><span style="color: #0000FF;">LocalOffsetY</span> <span style="color: #008000;">=</span> <span style="color: #008000;">+</span>relativeToCentre<span style="color: #008000;">;</span>
&nbsp;
  <span style="color: #008000;">}</span><span style="color: #008000;">;</span>
&nbsp;
targetElement<span style="color: #008000;">.</span><span style="color: #0000FF;">ManipulationCompleted</span> <span style="color: #008000;">+=</span> <span style="color: #008000;">(</span>s, e<span style="color: #008000;">)</span> <span style="color: #008000;">=&gt;</span>
  <span style="color: #008000;">{</span>
    <span style="color: #0600FF; font-weight: bold;">var</span> sb <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> Storyboard<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateAnimation<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">null</span>, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0.1</span>, <span style="color: #666666;">"RotationY"</span>, projection<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateAnimation<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">null</span>, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0.1</span>, <span style="color: #666666;">"RotationX"</span>, projection<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateAnimation<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">null</span>, <span style="color: #FF0000;">1</span>, <span style="color: #FF0000;">0.1</span>, <span style="color: #666666;">"ScaleX"</span>, scale<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">(</span>CreateAnimation<span style="color: #008000;">(</span><span style="color: #0600FF; font-weight: bold;">null</span>, <span style="color: #FF0000;">1</span>, <span style="color: #FF0000;">0.1</span>, <span style="color: #666666;">"ScaleY"</span>, scale<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
    sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Begin</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
    translate<span style="color: #008000;">.</span><span style="color: #0000FF;">Y</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span>
    projection<span style="color: #008000;">.</span><span style="color: #0000FF;">LocalOffsetY</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span>
  <span style="color: #008000;">}</span><span style="color: #008000;">;</span></pre></td></tr></table></div><p>Which results in the following effect:</p><p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/05/tilt3.png" alt="" title="tilt3" width="305" height="554" class="aligncenter size-full wp-image-1433" /></p><p>With that, the effect is complete!</p><p>Please note, the images in this blog post use a <code>Tilt</code> ‘factor’ of 6 in order to make the effect easier to see in these static images. I would urge you to use a much lower factor, perhaps 2, to make this effect much more subtle. I think it works best if the user almost doesn’t notice the effect, rather they ‘feel’ it.</p><p>You can download the full sourcecode for this blog post here: <a href="{{ site.url }}/blog/colin/wp-content/uploads/2011/05/MetroInMotion4.zip">MetroInMotion4.zip</a></p><p>Regards,<br />
Colin E.</p></div>