---
author: Colin Eberhardt
tags: Windows Phone 7, WP7Contrib
permalink: /blog/colin/2011/07/a-wp7-conversation-view/index.html
layout: colineberhardt-blog
---
<div class="entry"><div class="topsy_widget_data topsy_theme_light-green" style="float: right; margin-left: 0.75em; background: url(data:,%7B%20%22url%22%3A%20%22http%253A%252F%252Fwww.scottlogic.co.uk%252Fblog%252Fcolin%252F2011%252F07%252Fa-wp7-conversation-view%252F%22%2C%20%22style%22%3A%20%22big%22%2C%20%22title%22%3A%20%22Implementing%20a%20Windows%20Phone%207%20Conversation%20View%20%23%22%20%7D);"></div><p><em>This blog post looks at how to to create a conversation view, mimicking the SMS messaging interface within Windows Phone 7. This post shows how we can select different DataTemplate for each item in an ItemsControl to achieve this effect.</em></p><p>The Windows Phone 7 SMS messaging interface graphically illustrates between yourself and the other party by showing your messages as speech bubbles. Creating this view in your own application is not a straightforward process, with the template for each message being dependant on which side of the conversation it belongs to. In this blog post I will show how to create a simple template selector to achieve the view shown below:</p><p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/07/conversation.png" alt="" title="conversation" width="305" height="554" class="aligncenter size-full wp-image-1598" /></p><p>Firstly, we’ll start with the model that represents our conversation:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">enum</span> MessageSide
<span style="color: #008000;">{</span>
  Me,
  You
<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// An SMS message</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Message
<span style="color: #008000;">{</span> 
  <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">string</span> Text <span style="color: #008000;">{</span> <span style="color: #0600FF; font-weight: bold;">get</span><span style="color: #008000;">;</span> <span style="color: #0600FF; font-weight: bold;">set</span><span style="color: #008000;">;</span> <span style="color: #008000;">}</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">public</span> DateTime Timestamp <span style="color: #008000;">{</span> <span style="color: #0600FF; font-weight: bold;">get</span><span style="color: #008000;">;</span> <span style="color: #0600FF; font-weight: bold;">set</span><span style="color: #008000;">;</span> <span style="color: #008000;">}</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">public</span> MessageSide Side <span style="color: #008000;">{</span> <span style="color: #0600FF; font-weight: bold;">get</span><span style="color: #008000;">;</span> <span style="color: #0600FF; font-weight: bold;">set</span><span style="color: #008000;">;</span> <span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
<span style="color: #008080; font-style: italic;">/// A collection of messages</span>
<span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> MessageCollection <span style="color: #008000;">:</span> ObservableCollection<span style="color: #008000;">&lt;</span>Message<span style="color: #008000;">&gt;</span>
<span style="color: #008000;">{</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>It’s pretty simple, a collection of <code>Message</code> objects, each one with a <code>Text</code> and <code>Timestamp</code> property and a <code>Side</code> which indicates which side of the conversation it is on.</p><p>To aid in the design of this view, I created some design-time data:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;MessageCollection</span> <span style="color: #000066;">xmlns</span>=<span style="color: #ff0000;">"clr-namespace:WP7ConversationView"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"Hi, How are you?"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"You"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"Pretty good thanks. How are things at your end?"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"Me"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"The weather here is a bit grim"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"Me"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"Aye, not bad here, a bit of sun"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"You"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"Do you want to hear a joke?"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"You"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"Go on then"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"Me"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"Knock knock"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"You"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"Who's there?"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"Me"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"Doctor!"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"You"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"Doctor who?"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"Me"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"Doctor Who ... ha ha ROFLMAO"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"You"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Message</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"genius. Pure genius"</span> <span style="color: #000066;">Side</span>=<span style="color: #ff0000;">"Me"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/MessageCollection<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div><p>Formatting a <code>Message</code> instance so that it looks like a speech bubble is pretty straightforward. We create a grid with three rows, the first has the message text, the next has the date and the final one contains a path which renders a small triangle:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;contribConverters:StringFormatConverter</span> <span style="color: #000066;">x:Key</span>=<span style="color: #ff0000;">"StringFormatConverter"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
&nbsp;
&nbsp;
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Grid</span> <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"30, 10, 5, 0"</span></span>
<span style="color: #009900;">      <span style="color: #000066;">contribControls:GridUtils.RowDefinitions</span>=<span style="color: #ff0000;">",,"</span></span>
<span style="color: #009900;">      <span style="color: #000066;">Width</span>=<span style="color: #ff0000;">"420"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Rectangle</span> <span style="color: #000066;">Fill</span>=<span style="color: #ff0000;">"{StaticResource PhoneAccentBrush}"</span></span>
<span style="color: #009900;">             <span style="color: #000066;">Grid.RowSpan</span>=<span style="color: #ff0000;">"2"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"{Binding Path=Text}"</span></span>
<span style="color: #009900;">             <span style="color: #000066;">Style</span>=<span style="color: #ff0000;">"{StaticResource TextBlockStyle}"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"{Binding Path=Timestamp, Converter={StaticResource StringFormatConverter},</span>
<span style="color: #009900;">                                            ConverterParameter='ddd, HH:mm'}"</span></span>
<span style="color: #009900;">             <span style="color: #000066;">Style</span>=<span style="color: #ff0000;">"{StaticResource TimestampStyle}"</span></span>
<span style="color: #009900;">             <span style="color: #000066;">Grid.Row</span>=<span style="color: #ff0000;">"1"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Path</span> <span style="color: #000066;">Data</span>=<span style="color: #ff0000;">"m 0,0 l 16,0 l 0,16 l -16,-16"</span></span>
<span style="color: #009900;">        <span style="color: #000066;">Fill</span>=<span style="color: #ff0000;">"{StaticResource PhoneAccentBrush}"</span></span>
<span style="color: #009900;">        <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"0,0,5,0"</span></span>
<span style="color: #009900;">        <span style="color: #000066;">HorizontalAlignment</span>=<span style="color: #ff0000;">"Right"</span></span>
<span style="color: #009900;">        <span style="color: #000066;">Grid.Row</span>=<span style="color: #ff0000;">"2"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Grid<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div><p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/07/message.png" alt="" title="message" width="426" height="127" class="aligncenter size-full wp-image-1601" /></p><p>The above code uses a couple of useful little classes from the <a href="http://wp7contrib.codeplex.com/">WP7Contrib</a> project. The first is <code>GridUtils</code>, which gives a simplified grid syntax. In the above example three rows were constructed using the simple string <code>",,"</code>. The second is a <code>StringFormatConverter</code>, which formats bound values using the supplied string.</p><p>Now, the problem is, the above markup renders a speech bubble for messages that have been sent, for received messages we want the bubble to have different margins (aligning it to the left) and have the triangle at the top. This could be achieved using a horrible mess of value converters, however, it would be better if we could just use different markup for each.</p><p>WPF and Silverlight v5 have the concept of implicit <code>DataTemplates</code>, where a template is selected based on the type of the item being rendered, however, this feature is not present in WP7. Also, in this case we need to select a template based on the <code>Message.Side</code> property.</p><p>The Silverlight <code>ContentControl</code> renders the object assign to its <code>Content</code> property using the <code>DataTemplate</code> specified by the <code>ContentTemplate</code> property. It is actually very easy to extend this control to additional <code>DataTemplate</code> properties which are applied based on the bound data:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="csharp" style="font-family: monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> MessageContentPresenter <span style="color: #008000;">:</span> ContentControl
<span style="color: #008000;">{</span>
  <span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
  <span style="color: #008080; font-style: italic;">/// The DataTemplate to use when Message.Side == Side.Me</span>
  <span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
  <span style="color: #0600FF; font-weight: bold;">public</span> DataTemplate MeTemplate <span style="color: #008000;">{</span> <span style="color: #0600FF; font-weight: bold;">get</span><span style="color: #008000;">;</span> <span style="color: #0600FF; font-weight: bold;">set</span><span style="color: #008000;">;</span> <span style="color: #008000;">}</span>
&nbsp;
  <span style="color: #008080; font-style: italic;">/// &lt;summary&gt;</span>
  <span style="color: #008080; font-style: italic;">/// The DataTemplate to use when Message.Side == Side.You</span>
  <span style="color: #008080; font-style: italic;">/// &lt;/summary&gt;</span>
  <span style="color: #0600FF; font-weight: bold;">public</span> DataTemplate YouTemplate <span style="color: #008000;">{</span> <span style="color: #0600FF; font-weight: bold;">get</span><span style="color: #008000;">;</span> <span style="color: #0600FF; font-weight: bold;">set</span><span style="color: #008000;">;</span> <span style="color: #008000;">}</span>
&nbsp;
  <span style="color: #0600FF; font-weight: bold;">protected</span> <span style="color: #0600FF; font-weight: bold;">override</span> <span style="color: #6666cc; font-weight: bold;">void</span> OnContentChanged<span style="color: #008000;">(</span><span style="color: #6666cc; font-weight: bold;">object</span> oldContent, <span style="color: #6666cc; font-weight: bold;">object</span> newContent<span style="color: #008000;">)</span>
  <span style="color: #008000;">{</span>
    <span style="color: #0600FF; font-weight: bold;">base</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OnContentChanged</span><span style="color: #008000;">(</span>oldContent, newContent<span style="color: #008000;">)</span><span style="color: #008000;">;</span>
&nbsp;
    <span style="color: #008080; font-style: italic;">// apply the required template</span>
    Message message <span style="color: #008000;">=</span> newContent <span style="color: #0600FF; font-weight: bold;">as</span> Message<span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">(</span>message<span style="color: #008000;">.</span><span style="color: #0000FF;">Side</span> <span style="color: #008000;">==</span> MessageSide<span style="color: #008000;">.</span><span style="color: #0000FF;">Me</span><span style="color: #008000;">)</span>
    <span style="color: #008000;">{</span>
      ContentTemplate <span style="color: #008000;">=</span> MeTemplate<span style="color: #008000;">;</span>
    <span style="color: #008000;">}</span>
    <span style="color: #0600FF; font-weight: bold;">else</span>
    <span style="color: #008000;">{</span>
      ContentTemplate <span style="color: #008000;">=</span> YouTemplate<span style="color: #008000;">;</span>
    <span style="color: #008000;">}</span>
  <span style="color: #008000;">}</span>
<span style="color: #008000;">}</span></pre></td></tr></table></div><p>Using the above template-selector, we can supply different templates for the messages from either side of the conversation as follows:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family: monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;ItemsControl</span> <span style="color: #000066;">ItemsSource</span>=<span style="color: #ff0000;">"{Binding}"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;ItemsControl.ItemTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;DataTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:MessageContentPresenter</span> <span style="color: #000066;">Content</span>=<span style="color: #ff0000;">"{Binding}"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:MessageContentPresenter.MeTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
          <span style="color: #808080; font-style: italic;">&lt;!-- template for sent messages --&gt;</span>
          <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;DataTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Grid</span> <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"30, 10, 5, 0"</span></span>
<span style="color: #009900;">                  <span style="color: #000066;">contribControls:GridUtils.RowDefinitions</span>=<span style="color: #ff0000;">",,"</span></span>
<span style="color: #009900;">                  <span style="color: #000066;">Width</span>=<span style="color: #ff0000;">"420"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
              <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Rectangle</span> <span style="color: #000066;">Fill</span>=<span style="color: #ff0000;">"{StaticResource PhoneAccentBrush}"</span></span>
<span style="color: #009900;">                          <span style="color: #000066;">Grid.RowSpan</span>=<span style="color: #ff0000;">"2"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
              <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"{Binding Path=Text}"</span></span>
<span style="color: #009900;">                          <span style="color: #000066;">Style</span>=<span style="color: #ff0000;">"{StaticResource TextBlockStyle}"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
              <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"{Binding Path=Timestamp, Converter={StaticResource StringFormatConverter},</span>
<span style="color: #009900;">                                                        ConverterParameter='ddd, HH:mm'}"</span></span>
<span style="color: #009900;">                          <span style="color: #000066;">Style</span>=<span style="color: #ff0000;">"{StaticResource TimestampStyle}"</span></span>
<span style="color: #009900;">                          <span style="color: #000066;">Grid.Row</span>=<span style="color: #ff0000;">"1"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
              <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Path</span> <span style="color: #000066;">Data</span>=<span style="color: #ff0000;">"m 0,0 l 16,0 l 0,16 l -16,-16"</span></span>
<span style="color: #009900;">                    <span style="color: #000066;">Fill</span>=<span style="color: #ff0000;">"{StaticResource PhoneAccentBrush}"</span></span>
<span style="color: #009900;">                    <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"0,0,5,0"</span></span>
<span style="color: #009900;">                    <span style="color: #000066;">HorizontalAlignment</span>=<span style="color: #ff0000;">"Right"</span></span>
<span style="color: #009900;">                    <span style="color: #000066;">Grid.Row</span>=<span style="color: #ff0000;">"2"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Grid<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>                
          <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/DataTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:MessageContentPresenter.MeTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;local:MessageContentPresenter.YouTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
          <span style="color: #808080; font-style: italic;">&lt;!-- template for received messages --&gt;</span>
          <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;DataTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Grid</span> <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"5, 10, 30, 0"</span></span>
<span style="color: #009900;">                  <span style="color: #000066;">contribControls:GridUtils.RowDefinitions</span>=<span style="color: #ff0000;">",,"</span></span>
<span style="color: #009900;">                  <span style="color: #000066;">Width</span>=<span style="color: #ff0000;">"420"</span><span style="color: #000000; font-weight: bold;">&gt;</span></span>
              <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Path</span> <span style="color: #000066;">Data</span>=<span style="color: #ff0000;">"m 0,0 l 0,16 l 16,0 l -16,-16"</span></span>
<span style="color: #009900;">                    <span style="color: #000066;">Fill</span>=<span style="color: #ff0000;">"{StaticResource PhoneAccentBrush}"</span></span>
<span style="color: #009900;">                    <span style="color: #000066;">Margin</span>=<span style="color: #ff0000;">"5,0,0,0"</span></span>
<span style="color: #009900;">                    <span style="color: #000066;">HorizontalAlignment</span>=<span style="color: #ff0000;">"Left"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
              <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Rectangle</span> <span style="color: #000066;">Fill</span>=<span style="color: #ff0000;">"{StaticResource PhoneAccentBrush}"</span></span>
<span style="color: #009900;">                          <span style="color: #000066;">Grid.Row</span>=<span style="color: #ff0000;">"1"</span> <span style="color: #000066;">Grid.RowSpan</span>=<span style="color: #ff0000;">"2"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
              <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"{Binding Path=Text}"</span></span>
<span style="color: #009900;">                          <span style="color: #000066;">Style</span>=<span style="color: #ff0000;">"{StaticResource TextBlockStyle}"</span></span>
<span style="color: #009900;">                          <span style="color: #000066;">Grid.Row</span>=<span style="color: #ff0000;">"1"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
              <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;TextBlock</span> <span style="color: #000066;">Text</span>=<span style="color: #ff0000;">"{Binding Path=Timestamp, Converter={StaticResource StringFormatConverter},</span>
<span style="color: #009900;">                                                        ConverterParameter='ddd, HH:mm'}"</span></span>
<span style="color: #009900;">                          <span style="color: #000066;">Style</span>=<span style="color: #ff0000;">"{StaticResource TimestampStyle}"</span></span>
<span style="color: #009900;">                          <span style="color: #000066;">Grid.Row</span>=<span style="color: #ff0000;">"2"</span><span style="color: #000000; font-weight: bold;">/&gt;</span></span>
            <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/Grid<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
          <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/DataTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
        <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:MessageContentPresenter.YouTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
      <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/local:MessageContentPresenter<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
    <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/DataTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/ItemsControl.ItemTemplate<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/ItemsControl<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div><p>In the above XAML, the two templates are subtly different, rendering a triangle at a different grid location with a different orientation. The type of differences that would be hard to achieve via value converters.</p><p>I was able to test all of the above using design time data in Visual Studio, not having to execute the code once within the emulator!</p><p><img src="http://www.scottlogic.co.uk/blog/colin/wp-content/uploads/2011/07/WP7ConversationDesignTime.png" alt="" title="WP7ConversationDesignTime" width="600" height="328" class="aligncenter size-full wp-image-1604" /></p><p>You can download the full sourcecode for the project: <a href="{{ site.url }}/blog/colin/wp-content/uploads/2011/07/WP7ConversationView.zip">WP7ConversationView.zip</a></p><p>You can also read part two of this blog post, where I show how to implement the text input <a href="{{ site.url }}/blog/colin/2011/08/implementing-a-windows-phone-7-conversation-view-part-two/">giving a fully functional chat client</a>.</p><p>Regards, Colin E.</p></div>